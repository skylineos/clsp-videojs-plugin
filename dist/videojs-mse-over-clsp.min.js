!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}({"./node_modules/debug/src/browser.js":function(e,t,n){"use strict";(function(o){var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function s(e){return(s="function"===typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return"undefined"===typeof e?"undefined":r(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"===typeof e?"undefined":r(e)})(e)}t.log=function(){var e;return"object"===("undefined"===typeof console?"undefined":s(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var o=0,r=0;t[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(r=++o)}),t.splice(r,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!==typeof o&&"env"in o&&(e=o.env.DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n("./node_modules/debug/src/common.js")(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n("./node_modules/node-libs-browser/node_modules/process/browser.js"))},"./node_modules/debug/src/common.js":function(e,t,n){"use strict";e.exports=function(e){function t(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return o.colors[Math.abs(t)%o.colors.length]}function o(e){var n;function i(){if(i.enabled){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var s=i,a=Number(new Date),c=a-(n||a);s.diff=c,s.prev=n,s.curr=a,n=a,t[0]=o.coerce(t[0]),"string"!==typeof t[0]&&t.unshift("%O");var u=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(e,n){if("%%"===e)return e;u++;var r=o.formatters[n];if("function"===typeof r){var i=t[u];e=r.call(s,i),t.splice(u,1),u--}return e}),o.formatArgs.call(s,t),(s.log||o.log).apply(s,t)}}return i.namespace=e,i.enabled=o.enabled(e),i.useColors=o.useColors(),i.color=t(e),i.destroy=r,i.extend=s,"function"===typeof o.init&&o.init(i),o.instances.push(i),i}function r(){var e=o.instances.indexOf(this);return-1!==e&&(o.instances.splice(e,1),!0)}function s(e,t){return o(this.namespace+("undefined"===typeof t?":":t)+e)}return o.debug=o,o.default=o,o.coerce=function(e){return e instanceof Error?e.stack||e.message:e},o.disable=function(){o.enable("")},o.enable=function(e){var t;o.save(e),o.names=[],o.skips=[];var n=("string"===typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?o.skips.push(new RegExp("^"+e.substr(1)+"$")):o.names.push(new RegExp("^"+e+"$")));for(t=0;t<o.instances.length;t++){var s=o.instances[t];s.enabled=o.enabled(s.namespace)}},o.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=o.skips.length;t<n;t++)if(o.skips[t].test(e))return!1;for(t=0,n=o.names.length;t<n;t++)if(o.names[t].test(e))return!0;return!1},o.humanize=n("./node_modules/ms/index.js"),Object.keys(e).forEach(function(t){o[t]=e[t]}),o.instances=[],o.names=[],o.skips=[],o.formatters={},o.selectColor=t,o.enable(o.load()),o}},"./node_modules/global/document.js":function(e,t,n){(function(t){var o,r="undefined"!==typeof t?t:"undefined"!==typeof window?window:{},s=n(1);"undefined"!==typeof document?o=document:(o=r["__GLOBAL_DOCUMENT_CACHE@4"])||(o=r["__GLOBAL_DOCUMENT_CACHE@4"]=s),e.exports=o}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/lodash/_Symbol.js":function(e,t,n){var o=n("./node_modules/lodash/_root.js").Symbol;e.exports=o},"./node_modules/lodash/_apply.js":function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},"./node_modules/lodash/_arrayLikeKeys.js":function(e,t,n){var o=n("./node_modules/lodash/_baseTimes.js"),r=n("./node_modules/lodash/isArguments.js"),s=n("./node_modules/lodash/isArray.js"),i=n("./node_modules/lodash/isBuffer.js"),a=n("./node_modules/lodash/_isIndex.js"),c=n("./node_modules/lodash/isTypedArray.js"),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=s(e),d=!n&&r(e),l=!n&&!d&&i(e),f=!n&&!d&&!l&&c(e),h=n||d||l||f,p=h?o(e.length,String):[],m=p.length;for(var g in e)!t&&!u.call(e,g)||h&&("length"==g||l&&("offset"==g||"parent"==g)||f&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||a(g,m))||p.push(g);return p}},"./node_modules/lodash/_baseGetTag.js":function(e,t,n){var o=n("./node_modules/lodash/_Symbol.js"),r=n("./node_modules/lodash/_getRawTag.js"),s=n("./node_modules/lodash/_objectToString.js"),i="[object Null]",a="[object Undefined]",c=o?o.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?a:i:c&&c in Object(e)?r(e):s(e)}},"./node_modules/lodash/_baseIsArguments.js":function(e,t,n){var o=n("./node_modules/lodash/_baseGetTag.js"),r=n("./node_modules/lodash/isObjectLike.js"),s="[object Arguments]";e.exports=function(e){return r(e)&&o(e)==s}},"./node_modules/lodash/_baseIsNative.js":function(e,t,n){var o=n("./node_modules/lodash/isFunction.js"),r=n("./node_modules/lodash/_isMasked.js"),s=n("./node_modules/lodash/isObject.js"),i=n("./node_modules/lodash/_toSource.js"),a=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,d=c.toString,l=u.hasOwnProperty,f=RegExp("^"+d.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!s(e)||r(e))&&(o(e)?f:a).test(i(e))}},"./node_modules/lodash/_baseIsTypedArray.js":function(e,t,n){var o=n("./node_modules/lodash/_baseGetTag.js"),r=n("./node_modules/lodash/isLength.js"),s=n("./node_modules/lodash/isObjectLike.js"),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return s(e)&&r(e.length)&&!!i[o(e)]}},"./node_modules/lodash/_baseKeysIn.js":function(e,t,n){var o=n("./node_modules/lodash/isObject.js"),r=n("./node_modules/lodash/_isPrototype.js"),s=n("./node_modules/lodash/_nativeKeysIn.js"),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!o(e))return s(e);var t=r(e),n=[];for(var a in e)("constructor"!=a||!t&&i.call(e,a))&&n.push(a);return n}},"./node_modules/lodash/_baseRest.js":function(e,t,n){var o=n("./node_modules/lodash/identity.js"),r=n("./node_modules/lodash/_overRest.js"),s=n("./node_modules/lodash/_setToString.js");e.exports=function(e,t){return s(r(e,t,o),e+"")}},"./node_modules/lodash/_baseSetToString.js":function(e,t,n){var o=n("./node_modules/lodash/constant.js"),r=n("./node_modules/lodash/_defineProperty.js"),s=n("./node_modules/lodash/identity.js"),i=r?function(e,t){return r(e,"toString",{configurable:!0,enumerable:!1,value:o(t),writable:!0})}:s;e.exports=i},"./node_modules/lodash/_baseTimes.js":function(e,t){e.exports=function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}},"./node_modules/lodash/_baseUnary.js":function(e,t){e.exports=function(e){return function(t){return e(t)}}},"./node_modules/lodash/_coreJsData.js":function(e,t,n){var o=n("./node_modules/lodash/_root.js")["__core-js_shared__"];e.exports=o},"./node_modules/lodash/_defineProperty.js":function(e,t,n){var o=n("./node_modules/lodash/_getNative.js"),r=function(){try{var e=o(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=r},"./node_modules/lodash/_freeGlobal.js":function(e,t,n){(function(t){var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o="object"==("undefined"===typeof t?"undefined":n(t))&&t&&t.Object===Object&&t;e.exports=o}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/lodash/_getNative.js":function(e,t,n){var o=n("./node_modules/lodash/_baseIsNative.js"),r=n("./node_modules/lodash/_getValue.js");e.exports=function(e,t){var n=r(e,t);return o(n)?n:void 0}},"./node_modules/lodash/_getRawTag.js":function(e,t,n){var o=n("./node_modules/lodash/_Symbol.js"),r=Object.prototype,s=r.hasOwnProperty,i=r.toString,a=o?o.toStringTag:void 0;e.exports=function(e){var t=s.call(e,a),n=e[a];try{e[a]=void 0;var o=!0}catch(e){}var r=i.call(e);return o&&(t?e[a]=n:delete e[a]),r}},"./node_modules/lodash/_getValue.js":function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},"./node_modules/lodash/_isIndex.js":function(e,t){var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=9007199254740991,r=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var s="undefined"===typeof e?"undefined":n(e);return!!(t=null==t?o:t)&&("number"==s||"symbol"!=s&&r.test(e))&&e>-1&&e%1==0&&e<t}},"./node_modules/lodash/_isIterateeCall.js":function(e,t,n){var o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n("./node_modules/lodash/eq.js"),s=n("./node_modules/lodash/isArrayLike.js"),i=n("./node_modules/lodash/_isIndex.js"),a=n("./node_modules/lodash/isObject.js");e.exports=function(e,t,n){if(!a(n))return!1;var c="undefined"===typeof t?"undefined":o(t);return!!("number"==c?s(n)&&i(t,n.length):"string"==c&&t in n)&&r(n[t],e)}},"./node_modules/lodash/_isMasked.js":function(e,t,n){var o,r=n("./node_modules/lodash/_coreJsData.js"),s=(o=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+o:"";e.exports=function(e){return!!s&&s in e}},"./node_modules/lodash/_isPrototype.js":function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},"./node_modules/lodash/_nativeKeysIn.js":function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},"./node_modules/lodash/_nodeUtil.js":function(e,t,n){(function(e){var o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n("./node_modules/lodash/_freeGlobal.js"),s="object"==o(t)&&t&&!t.nodeType&&t,i=s&&"object"==o(e)&&e&&!e.nodeType&&e,a=i&&i.exports===s&&r.process,c=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=c}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"./node_modules/lodash/_objectToString.js":function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},"./node_modules/lodash/_overRest.js":function(e,t,n){var o=n("./node_modules/lodash/_apply.js"),r=Math.max;e.exports=function(e,t,n){return t=r(void 0===t?e.length-1:t,0),function(){for(var s=arguments,i=-1,a=r(s.length-t,0),c=Array(a);++i<a;)c[i]=s[t+i];i=-1;for(var u=Array(t+1);++i<t;)u[i]=s[i];return u[t]=n(c),o(e,this,u)}}},"./node_modules/lodash/_root.js":function(e,t,n){var o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n("./node_modules/lodash/_freeGlobal.js"),s="object"==("undefined"===typeof self?"undefined":o(self))&&self&&self.Object===Object&&self,i=r||s||Function("return this")();e.exports=i},"./node_modules/lodash/_setToString.js":function(e,t,n){var o=n("./node_modules/lodash/_baseSetToString.js"),r=n("./node_modules/lodash/_shortOut.js")(o);e.exports=r},"./node_modules/lodash/_shortOut.js":function(e,t){var n=800,o=16,r=Date.now;e.exports=function(e){var t=0,s=0;return function(){var i=r(),a=o-(i-s);if(s=i,a>0){if(++t>=n)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},"./node_modules/lodash/_toSource.js":function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},"./node_modules/lodash/constant.js":function(e,t){e.exports=function(e){return function(){return e}}},"./node_modules/lodash/defaults.js":function(e,t,n){var o=n("./node_modules/lodash/_baseRest.js"),r=n("./node_modules/lodash/eq.js"),s=n("./node_modules/lodash/_isIterateeCall.js"),i=n("./node_modules/lodash/keysIn.js"),a=Object.prototype,c=a.hasOwnProperty,u=o(function(e,t){e=Object(e);var n=-1,o=t.length,u=o>2?t[2]:void 0;for(u&&s(t[0],t[1],u)&&(o=1);++n<o;)for(var d=t[n],l=i(d),f=-1,h=l.length;++f<h;){var p=l[f],m=e[p];(void 0===m||r(m,a[p])&&!c.call(e,p))&&(e[p]=d[p])}return e});e.exports=u},"./node_modules/lodash/eq.js":function(e,t){e.exports=function(e,t){return e===t||e!==e&&t!==t}},"./node_modules/lodash/identity.js":function(e,t){e.exports=function(e){return e}},"./node_modules/lodash/isArguments.js":function(e,t,n){var o=n("./node_modules/lodash/_baseIsArguments.js"),r=n("./node_modules/lodash/isObjectLike.js"),s=Object.prototype,i=s.hasOwnProperty,a=s.propertyIsEnumerable,c=o(function(){return arguments}())?o:function(e){return r(e)&&i.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},"./node_modules/lodash/isArray.js":function(e,t){var n=Array.isArray;e.exports=n},"./node_modules/lodash/isArrayLike.js":function(e,t,n){var o=n("./node_modules/lodash/isFunction.js"),r=n("./node_modules/lodash/isLength.js");e.exports=function(e){return null!=e&&r(e.length)&&!o(e)}},"./node_modules/lodash/isBuffer.js":function(e,t,n){(function(e){var o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n("./node_modules/lodash/_root.js"),s=n("./node_modules/lodash/stubFalse.js"),i="object"==o(t)&&t&&!t.nodeType&&t,a=i&&"object"==o(e)&&e&&!e.nodeType&&e,c=a&&a.exports===i?r.Buffer:void 0,u=(c?c.isBuffer:void 0)||s;e.exports=u}).call(this,n("./node_modules/webpack/buildin/module.js")(e))},"./node_modules/lodash/isFunction.js":function(e,t,n){var o=n("./node_modules/lodash/_baseGetTag.js"),r=n("./node_modules/lodash/isObject.js"),s="[object AsyncFunction]",i="[object Function]",a="[object GeneratorFunction]",c="[object Proxy]";e.exports=function(e){if(!r(e))return!1;var t=o(e);return t==i||t==a||t==s||t==c}},"./node_modules/lodash/isLength.js":function(e,t){var n=9007199254740991;e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}},"./node_modules/lodash/isObject.js":function(e,t){var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){var t="undefined"===typeof e?"undefined":n(e);return null!=e&&("object"==t||"function"==t)}},"./node_modules/lodash/isObjectLike.js":function(e,t){var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return null!=e&&"object"==("undefined"===typeof e?"undefined":n(e))}},"./node_modules/lodash/isTypedArray.js":function(e,t,n){var o=n("./node_modules/lodash/_baseIsTypedArray.js"),r=n("./node_modules/lodash/_baseUnary.js"),s=n("./node_modules/lodash/_nodeUtil.js"),i=s&&s.isTypedArray,a=i?r(i):o;e.exports=a},"./node_modules/lodash/keysIn.js":function(e,t,n){var o=n("./node_modules/lodash/_arrayLikeKeys.js"),r=n("./node_modules/lodash/_baseKeysIn.js"),s=n("./node_modules/lodash/isArrayLike.js");e.exports=function(e){return s(e)?o(e,!0):r(e)}},"./node_modules/lodash/noop.js":function(e,t){e.exports=function(){}},"./node_modules/lodash/stubFalse.js":function(e,t){e.exports=function(){return!1}},"./node_modules/ms/index.js":function(e,t){var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=1e3,r=60*o,s=60*r,i=24*s,a=7*i,c=365.25*i;function u(e,t,n,o){var r=t>=1.5*n;return Math.round(e/n)+" "+o+(r?"s":"")}e.exports=function(e,t){t=t||{};var d="undefined"===typeof e?"undefined":n(e);if("string"===d&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*c;case"weeks":case"week":case"w":return n*a;case"days":case"day":case"d":return n*i;case"hours":case"hour":case"hrs":case"hr":case"h":return n*s;case"minutes":case"minute":case"mins":case"min":case"m":return n*r;case"seconds":case"second":case"secs":case"sec":case"s":return n*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(e);if("number"===d&&!1===isNaN(e))return t.long?function(e){var t=Math.abs(e);if(t>=i)return u(e,t,i,"day");if(t>=s)return u(e,t,s,"hour");if(t>=r)return u(e,t,r,"minute");if(t>=o)return u(e,t,o,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=i)return Math.round(e/i)+"d";if(t>=s)return Math.round(e/s)+"h";if(t>=r)return Math.round(e/r)+"m";if(t>=o)return Math.round(e/o)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"./node_modules/node-libs-browser/node_modules/process/browser.js":function(e,t){var n,o,r=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:s}catch(e){n=s}try{o="function"===typeof clearTimeout?clearTimeout:i}catch(e){o=i}}();var c,u=[],d=!1,l=-1;function f(){d&&c&&(d=!1,c.length?u=c.concat(u):l=-1,u.length&&h())}function h(){if(!d){var e=a(f);d=!0;for(var t=u.length;t;){for(c=u,u=[];++l<t;)c&&c[l].run();l=-1,t=u.length}c=null,d=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===i||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||d||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},"./node_modules/srcdoc-polyfill/srcdoc-polyfill.js":function(e,t,n){var o,r,s;"function"===typeof Symbol&&Symbol.iterator;r=this,s=window.srcDoc,void 0===(o=function(e){!function(e,t){var n,o,r,s=!!("srcdoc"in document.createElement("iframe")),i="Polyfill may not function in the presence of the `sandbox` attribute. Consider using the `force` option.",a=/\ballow-same-origin\b/,c=function(e,t){var n=e.getAttribute("sandbox");"string"!==typeof n||a.test(n)||(t&&t.force?e.removeAttribute("sandbox"):t&&!1===t.force||(r(i),e.setAttribute("data-srcdoc-polyfill",i)))},u={compliant:function(e,t,n){t&&(c(e,n),e.setAttribute("srcdoc",t))},legacy:function(e,t,n){var o;e&&e.getAttribute&&(t?e.setAttribute("srcdoc",t):t=e.getAttribute("srcdoc"),t&&(c(e,n),o="javascript: window.frameElement.getAttribute('srcdoc');",e.contentWindow&&(e.contentWindow.location=o),e.setAttribute("src",o)))}},d=e;if(r=window.console&&window.console.error?function(e){window.console.error("[srcdoc-polyfill] "+e)}:function(){},d.set=u.compliant,d.noConflict=function(){return window.srcDoc=t,d},!s)for(d.set=u.legacy,o=document.getElementsByTagName("iframe"),n=o.length;n--;)d.set(o[n])}(e,s),r.srcDoc=e}.apply(t,[t]))||(e.exports=o)},"./node_modules/uuid/lib/bytesToUuid.js":function(e,t){for(var n=[],o=0;o<256;++o)n[o]=(o+256).toString(16).substr(1);e.exports=function(e,t){var o=t||0,r=n;return[r[e[o++]],r[e[o++]],r[e[o++]],r[e[o++]],"-",r[e[o++]],r[e[o++]],"-",r[e[o++]],r[e[o++]],"-",r[e[o++]],r[e[o++]],"-",r[e[o++]],r[e[o++]],r[e[o++]],r[e[o++]],r[e[o++]],r[e[o++]]].join("")}},"./node_modules/uuid/lib/rng-browser.js":function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var o=new Uint8Array(16);e.exports=function(){return n(o),o}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},"./node_modules/uuid/v4.js":function(e,t,n){var o=n("./node_modules/uuid/lib/rng-browser.js"),r=n("./node_modules/uuid/lib/bytesToUuid.js");e.exports=function(e,t,n){var s=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||o)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var a=0;a<16;++a)t[s+a]=i[a];return t||r(i)}},"./node_modules/videojs-errors/dist/videojs-errors.es.js":function(e,t,n){"use strict";n.r(t);var o=n("video.js"),r=n.n(o),s=n("./node_modules/global/document.js"),i=n.n(s),a=r.a.getComponent("Flash"),c=!r.a.browser.IS_IPHONE,u=r.a.registerPlugin||r.a.plugin,d={header:"",code:"",message:"",timeout:45e3,dismiss:c,errors:{1:{type:"MEDIA_ERR_ABORTED",headline:"The video download was cancelled"},2:{type:"MEDIA_ERR_NETWORK",headline:"The video connection was lost, please confirm you are connected to the internet"},3:{type:"MEDIA_ERR_DECODE",headline:"The video is bad or in a format that cannot be played on your browser"},4:{type:"MEDIA_ERR_SRC_NOT_SUPPORTED",headline:"This video is either unavailable or not supported in this browser"},5:{type:"MEDIA_ERR_ENCRYPTED",headline:"The video you are trying to watch is encrypted and we do not know how to decrypt it"},unknown:{type:"MEDIA_ERR_UNKNOWN",headline:"An unanticipated problem was encountered, check back soon and try again"},"-1":{type:"PLAYER_ERR_NO_SRC",headline:"No video has been loaded"},"-2":{type:"PLAYER_ERR_TIMEOUT",headline:"Could not download the video"},PLAYER_ERR_DOMAIN_RESTRICTED:{headline:"This video is restricted from playing on your current domain"},PLAYER_ERR_IP_RESTRICTED:{headline:"This video is restricted at your current IP address"},PLAYER_ERR_GEO_RESTRICTED:{headline:"This video is restricted from playing in your current geographic region"},FLASHLS_ERR_CROSS_DOMAIN:{headline:"The video could not be loaded: crossdomain access denied."}}},l=function e(t,n){var o,s,c,u=[],l=function(e){n.errors=r.a.mergeOptions(n.errors,e),Object.keys(n.errors).forEach(function(e){var t=n.errors[e];t.type||(t.type=e)})};l();var f=function(){t.clearTimeout(s),c&&(c=!1,t.removeClass("vjs-waiting")),s=t.setTimeout(function(){t.error()||t.paused()||t.ended()||(c=!0,t.addClass("vjs-waiting"))},1e3),t.clearTimeout(o),o=t.setTimeout(function(){t.error()||t.paused()||t.ended()||t.error({code:-2,type:"PLAYER_ERR_TIMEOUT"})},n.timeout),t.error()&&-2===t.error().code&&t.error(null)},h=function(){for(var e;u.length;)e=u.shift(),t.off(e[0],e[1]);t.clearTimeout(o),t.clearTimeout(s)},p=function(){var e,n,o,r=0;h(),f(),e=["timeupdate","adtimeupdate"],n=function(){var e=t.currentTime();e!==r&&(r=e,f())},o=function(){if(!t.error()){var e=t.$(".vjs-tech");if(e&&"application/x-shockwave-flash"===e.type&&!e.vjs_getProperty)return void t.error({code:-2,type:"PLAYER_ERR_TIMEOUT"});if(t.paused())return f();if(t.ended())return f()}n.call(this)},t.on(e,o),u.push([e,o])},m=function(){t.currentSrc()||t.error({code:-1,type:"PLAYER_ERR_NO_SRC"})},g=function(){var e="",o=t.error(),s=i.a.createElement("div"),c="";if(o){if((o=r.a.mergeOptions(o,n.errors[o.code||o.type||0])).message&&(e='<div class="vjs-errors-details">'+t.localize("Technical details")+'\n        : <div class="vjs-errors-message">'+t.localize(o.message)+"</div>\n        </div>"),4===o.code&&a&&!a.isSupported())e+='<span class="vjs-errors-flashmessage">'+t.localize("If you are using an older browser please try upgrading or installing Flash.")+"</span>";var u=t.getChild("errorDisplay");if(s.className="vjs-errors-dialog",s.id="vjs-errors-dialog",c='<div class="vjs-errors-content-container">\n      <h2 class="vjs-errors-headline">'+this.localize(o.headline)+"</h2>\n        <div><b>"+this.localize("Error Code")+"</b>: "+(o.type||o.code)+"</div>\n        "+e+"\n      </div>",u.closeable(!("dismiss"in o)||o.dismiss)){c+='<div class="vjs-errors-ok-button-container">\n          <button class="vjs-errors-ok-button">'+this.localize("OK")+"</button>\n        </div>",s.innerHTML=c,u.fillWith(s),u.contentEl().firstChild.appendChild(u.getChild("closeButton").el());var d=u.el().querySelector(".vjs-errors-ok-button");t.on(d,"click",function(){u.close()})}else s.innerHTML=c,u.fillWith(s);(t.currentWidth()<=600||t.currentHeight()<=250)&&u.addClass("vjs-xs"),u.one("modalclose",function(){return t.error(null)})}},v=function e(){h(),t.removeClass("vjs-errors"),t.off("play",p),t.off("play",m),t.off("dispose",e),t.off(["aderror","error"],g)},y=function(n){v(),e(t,r.a.mergeOptions(d,n))};y.extend=function(e){return l(e)},y.getAll=function(){return r.a.mergeOptions(n.errors)},y.timeout=function(e){if("undefined"===typeof e)return n.timeout;e!==n.timeout&&(n.timeout=e,t.paused()||p())},y.disableProgress=function(){},t.on("play",p),t.on("play",m),t.on("dispose",v),t.on(["aderror","error"],g),t.ready(function(){t.addClass("vjs-errors")}),t.paused()||p(),y.VERSION="4.2.0",t.errors=y},f=function(e){l(this,r.a.mergeOptions(d,e))};["extend","getAll"].forEach(function(e){f[e]=function(){r.a.log.warn("The errors."+e+"() method is not available until the plugin has been initialized!")}}),f.VERSION="4.2.0",u("errors",f),t.default=f},"./node_modules/webpack/buildin/global.js":function(e,t){var n,o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"===("undefined"===typeof window?"undefined":o(window))&&(n=window)}e.exports=n},"./node_modules/webpack/buildin/module.js":function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},"./package.json":function(e){e.exports={name:"videojs-mse-over-clsp",version:"0.13.4",description:"Uses clsp (iot) as a video distribution system, video is is received via the clsp client then rendered using the media source extensions. ",main:"dist/videojs-mse-over-clsp.js","generator-videojs-plugin":{version:"5.0.0"},scripts:{build:"gulp build",lint:"eslint ./ --cache --quiet --ext .jsx --ext .js","lint-fix":"eslint ./ --cache --quiet --ext .jsx --ext .js --fix",version:"./scripts/version.sh",postversion:"git push && git push --tags",serve:"./scripts/serve.js","serve-watch":"npm run build && npm run serve"},keywords:["videojs","videojs-plugin"],author:"dschere@skylinenet.net",license:"MIT",dependencies:{debug:"^3.1.0",lodash:"^4.17.10",moment:"^2.22.2","node-sass":"^4.9.1","paho-mqtt":"^1.0.4","videojs-errors":"^4.1.1"},devDependencies:{"babel-core":"^6.26.3","babel-eslint":"^8.2.5","babel-loader":"^7.1.5","babel-plugin-transform-class-properties":"^6.24.1","babel-plugin-transform-object-rest-spread":"^6.26.0","babel-polyfill":"^6.26.0","babel-preset-env":"^1.7.0","css-loader":"^0.28.11",eslint:"^5.0.1","extract-text-webpack-plugin":"^4.0.0-beta.0",gulp:"^3.9.1","gulp-load-plugins":"^1.5.0","gulp-rm":"^1.0.5",jquery:"^3.3.1","js-string-escape":"^1.0.1","pre-commit":"^1.2.2","run-sequence":"^2.2.0","sass-loader":"^7.0.3","srcdoc-polyfill":"^1.0.0",standard:"^11.0.1","style-loader":"^0.21.0","uglifyjs-webpack-plugin":"^1.2.7","url-loader":"^1.0.1","video.js":"6.7.1",webpack:"^4.15.1","webpack-serve":"^2.0.2"}}},"./src/js/MqttConduitCollection.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/debug/src/browser.js"),r=n.n(o),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i="skyline:clsp",a=void 0,c=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.debug=r()(i+":MqttConduitCollection"),this.debug("constructing..."),this._conduits={},window.addEventListener("message",function(e){t.debug("window on message");var n=e.data.clientId;t.exists(n)?t.getById(n).iov.onMessage(e):"fail"===!e.data.event&&console.error('No conduit with id "'+n+'" exists!')})}return s(e,null,[{key:"factory",value:function(){return a||(a=new e),a}}]),s(e,[{key:"set",value:function(e,t){return this.debug("setting...",e,t),this._conduits[e]=t,t}},{key:"remove",value:function(e){delete this._conduits[e]}},{key:"addFromIov",value:function(e){this.debug("adding from iov...",e);var t=this.exists(e.config.clientId)?this.getById(e.config.clientId):window.mqttConduit(e);return this.set(e.config.clientId,t)}},{key:"getById",value:function(e){return this.debug("getting...",e),this._conduits[e]}},{key:"exists",value:function(e){return this.debug("exists?",e),this._conduits.hasOwnProperty(e)}}]),e}();t.default=c},"./src/js/MqttHandler.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/debug/src/browser.js"),r=n.n(o),s=n("video.js"),i=n.n(s),a=n("./src/js/iov/IOV.js"),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var u=i.a.getComponent("Component"),d="skyline:clsp",l=function(e){function t(e,n,o,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,s.mqtt));return i.debug=r()(d+":MqttHandler"),i.debug("constructor"),i.tech_=n,i.source_=e,i.iov=null,i.mqttConduitCollection=o,i}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u),c(t,[{key:"createIOV",value:function(e){this.debug("createIOV"),this.updateIOV(a.default.fromUrl(this.source_.src,this.mqttConduitCollection,e)),this.iov.initialize()}},{key:"updateIOV",value:function(e){if(this.debug("updateIOV"),this.iov){if(this.iov.id===e.id)return;this.iov.destroy()}this.iov=e}}]),t}();t.default=l},"./src/js/MqttSourceHandler.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/debug/src/browser.js"),r=n.n(o),s=n("video.js"),i=n.n(s),a=n("./src/js/MqttHandler.js"),c=n("./src/js/utils.js");t.default=function(){var e=r()("skyline:clsp:MqttSourceHandler");return function(t,n){var o={canHandleSource:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e("canHandleSource"),t.src?t.src.startsWith("clsp")?c.default.supported()?o.canPlayType(t.type):(e("Browser not supported. Chrome 52+ is required."),!1):(console.error("srcObj.src is not clsp protocol"),!1):(console.error("srcObj doesn't contain src"),e(t),!1)},handleSource:function(o,r){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e("handleSource");var c=i.a.mergeOptions(i.a.options,s,{mqtt:{mode:t}});return r.mqtt=new a.default(o,r,n,c),r.mqtt},canPlayType:function(t){return e("canPlayType"),"video/mp4; codecs='avc1.42E01E'"===t?"maybe":(console.error("clsp type='"+t+"' rejected"),"")}};return o}}},"./src/js/MseOverMqttPlugin.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/debug/src/browser.js"),r=n.n(o),s=n("video.js"),i=n.n(s),a=n("./package.json"),c=n("./src/js/MqttSourceHandler.js"),u=n("./src/js/MqttConduitCollection.js"),d=n("./src/js/utils.js"),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var h=i.a.getPlugin("plugin"),p="skyline:clsp",m=!1;t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(t){function n(t,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var s,a=f(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,o));return a.debug=r()(p+":MseOverMqttPlugin"),a.debug("constructor"),o=i.a.mergeOptions(e,o),t.addClass("vjs-mse-over-mqtt"),o.customClass&&t.addClass(o.customClass),t.errors({errors:{PLAYER_ERR_NOT_COMPAT:{headline:"This browser is unsupported.",message:"Chrome 52+ is required."}},timeout:12e4}),d.default.supported()?(t._currentTime=0,t.currentTime=function(){return t._currentTime++},t.on("firstplay",function(e){a.debug("on firstplay");var n=t.tech(!0).mqtt;if(!n)return console.error("src not in lookup table");n.createIOV(t),n.iov.player.on("metric",function(e){a.trigger("metric",{metric:e})})}),a):(s=t.error({code:"PLAYER_ERR_NOT_COMPAT",dismiss:!1}),f(a,s))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,h),l(n,null,[{key:"register",value:function(){if(m)throw new Error("You can only register the clsp plugin once, and it has already been registered.");return m=!0,i.a.getTech("Html5").registerSourceHandler(Object(c.default)()("html5",u.default.factory()),0),i.a.registerPlugin(n.pluginName,n),n}}]),n}();return t.pluginName="clsp",t.VERSION=a.version,t.utils=d.default,t}},"./src/js/conduit/clspConduit.generated.js":function(e,t){window.mqttConduit=function(e){var t=document.createElement("iframe"),n=e.config.useSSL?"true":"false",o="<html><head><script>\nvar MqttIp = '"+e.config.wsbroker+"' ; \nvar MqttPort = "+e.config.wsport+"; \nvar MqttUseSSL = "+n+"; \nvar MqttClientId = '"+e.config.clientId+"' ; \nvar Origin = '"+window.location.origin+'\' ; \n/*******************************************************************************\n * Copyright (c) 2013, 2016 IBM Corp.\n *\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * and Eclipse Distribution License v1.0 which accompany this distribution.\n *\n * The Eclipse Public License is available at\n *    http://www.eclipse.org/legal/epl-v10.html\n * and the Eclipse Distribution License is available at\n *   http://www.eclipse.org/org/documents/edl-v10.php.\n *\n *******************************************************************************/\n(function(t,q){"object"===typeof exports&&"object"===typeof module?module.exports=q():"function"===typeof define&&define.amd?define(q):"object"===typeof exports?exports=q():t.Paho=q()})(this,function(){return function(t){function q(a,b,c){b[c++]=a>>8;b[c++]=a%256;return c}function r(a,b,c,k){k=q(b,c,k);E(a,c,k);return k+b}function n(a){for(var b=0,c=0;c<a.length;c++){var k=a.charCodeAt(c);2047<k?(55296<=k&&56319>=k&&(c++,b++),b+=3):127<k?b+=2:b++}return b}function E(a,b,c){for(var k=0;k<a.length;k++){var e=\n    a.charCodeAt(k);if(55296<=e&&56319>=e){var g=a.charCodeAt(++k);if(isNaN(g))throw Error(f(h.MALFORMED_UNICODE,[e,g]));e=(e-55296<<10)+(g-56320)+65536}127>=e?b[c++]=e:(2047>=e?b[c++]=e>>6&31|192:(65535>=e?b[c++]=e>>12&15|224:(b[c++]=e>>18&7|240,b[c++]=e>>12&63|128),b[c++]=e>>6&63|128),b[c++]=e&63|128)}return b}function F(a,b,c){for(var k="",e,g=b;g<b+c;){e=a[g++];if(!(128>e)){var m=a[g++]-128;if(0>m)throw Error(f(h.MALFORMED_UTF,[e.toString(16),m.toString(16),""]));if(224>e)e=64*(e-192)+m;else{var d=\n    a[g++]-128;if(0>d)throw Error(f(h.MALFORMED_UTF,[e.toString(16),m.toString(16),d.toString(16)]));if(240>e)e=4096*(e-224)+64*m+d;else{var l=a[g++]-128;if(0>l)throw Error(f(h.MALFORMED_UTF,[e.toString(16),m.toString(16),d.toString(16),l.toString(16)]));if(248>e)e=262144*(e-240)+4096*m+64*d+l;else throw Error(f(h.MALFORMED_UTF,[e.toString(16),m.toString(16),d.toString(16),l.toString(16)]));}}}65535<e&&(e-=65536,k+=String.fromCharCode(55296+(e>>10)),e=56320+(e&1023));k+=String.fromCharCode(e)}return k}\n    var s=t.localStorage||function(){var a={};return{setItem:function(b,c){a[b]=c},getItem:function(b){return a[b]},removeItem:function(b){delete a[b]}}}(),A=function(a,b){for(var c in a)if(a.hasOwnProperty(c))if(b.hasOwnProperty(c)){if(typeof a[c]!==b[c])throw Error(f(h.INVALID_TYPE,[typeof a[c],c]));}else{c="Unknown property, "+c+". Valid properties are:";for(var k in b)b.hasOwnProperty(k)&&(c=c+" "+k);throw Error(c);}},u=function(a,b){return function(){return a.apply(b,arguments)}},h={OK:{code:0,text:"AMQJSC0000I OK."},\n    CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,\n    text:"AMQJS0008I Socket closed."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key\\x3d{0} value\\x3d{1}."},\n    INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."},BUFFER_FULL:{code:18,text:"AMQJS0018E Message buffer is full, maximum buffer size: {0}."}},H={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},\n    f=function(a,b){var c=a.text;if(b)for(var k,e,g=0;g<b.length;g++)if(k="{"+g+"}",e=c.indexOf(k),0<e)var h=c.substring(0,e),c=c.substring(e+k.length),c=h+b[g]+c;return c},B=[0,6,77,81,73,115,100,112,3],C=[0,4,77,81,84,84,4],p=function(a,b){this.type=a;for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c])};p.prototype.encode=function(){var a=(this.type&15)<<4,b=0,c=[],k=0,e;void 0!==this.messageIdentifier&&(b+=2);switch(this.type){case 1:switch(this.mqttVersion){case 3:b+=B.length+3;break;case 4:b+=C.length+\n    3}b+=n(this.clientId)+2;void 0!==this.willMessage&&(b+=n(this.willMessage.destinationName)+2,e=this.willMessage.payloadBytes,e instanceof Uint8Array||(e=new Uint8Array(h)),b+=e.byteLength+2);void 0!==this.userName&&(b+=n(this.userName)+2);void 0!==this.password&&(b+=n(this.password)+2);break;case 8:for(var a=a|2,g=0;g<this.topics.length;g++)c[g]=n(this.topics[g]),b+=c[g]+2;b+=this.requestedQos.length;break;case 10:a|=2;for(g=0;g<this.topics.length;g++)c[g]=n(this.topics[g]),b+=c[g]+2;break;case 6:a|=\n    2;break;case 3:this.payloadMessage.duplicate&&(a|=8);a=a|=this.payloadMessage.qos<<1;this.payloadMessage.retained&&(a|=1);var k=n(this.payloadMessage.destinationName),h=this.payloadMessage.payloadBytes,b=b+(k+2)+h.byteLength;h instanceof ArrayBuffer?h=new Uint8Array(h):h instanceof Uint8Array||(h=new Uint8Array(h.buffer))}var f=b,g=Array(1),d=0;do{var z=f%128,f=f>>7;0<f&&(z|=128);g[d++]=z}while(0<f&&4>d);f=g.length+1;b=new ArrayBuffer(b+f);d=new Uint8Array(b);d[0]=a;d.set(g,1);if(3==this.type)f=r(this.payloadMessage.destinationName,\n    k,d,f);else if(1==this.type){switch(this.mqttVersion){case 3:d.set(B,f);f+=B.length;break;case 4:d.set(C,f),f+=C.length}a=0;this.cleanSession&&(a=2);void 0!==this.willMessage&&(a=a|4|this.willMessage.qos<<3,this.willMessage.retained&&(a|=32));void 0!==this.userName&&(a|=128);void 0!==this.password&&(a|=64);d[f++]=a;f=q(this.keepAliveInterval,d,f)}void 0!==this.messageIdentifier&&(f=q(this.messageIdentifier,d,f));switch(this.type){case 1:f=r(this.clientId,n(this.clientId),d,f);void 0!==this.willMessage&&\n    (f=r(this.willMessage.destinationName,n(this.willMessage.destinationName),d,f),f=q(e.byteLength,d,f),d.set(e,f),f+=e.byteLength);void 0!==this.userName&&(f=r(this.userName,n(this.userName),d,f));void 0!==this.password&&r(this.password,n(this.password),d,f);break;case 3:d.set(h,f);break;case 8:for(g=0;g<this.topics.length;g++)f=r(this.topics[g],c[g],d,f),d[f++]=this.requestedQos[g];break;case 10:for(g=0;g<this.topics.length;g++)f=r(this.topics[g],c[g],d,f)}return b};var G=function(a,b){this._client=\n    a;this._keepAliveInterval=1E3*b;this.isReset=!1;var c=(new p(12)).encode(),k=function(a){return function(){return e.apply(a)}},e=function(){this.isReset?(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(c),this.timeout=setTimeout(k(this),this._keepAliveInterval)):(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(h.PING_TIMEOUT.code,f(h.PING_TIMEOUT)))};this.reset=function(){this.isReset=!0;clearTimeout(this.timeout);0<this._keepAliveInterval&&\n    (this.timeout=setTimeout(k(this),this._keepAliveInterval))};this.cancel=function(){clearTimeout(this.timeout)}},v=function(a,b,c,f){b||(b=30);this.timeout=setTimeout(function(a,b,c){return function(){return a.apply(b,c)}}(c,a,f),1E3*b);this.cancel=function(){clearTimeout(this.timeout)}},d=function(a,b,c,d,e){if(!("WebSocket"in t&&null!==t.WebSocket))throw Error(f(h.UNSUPPORTED,["WebSocket"]));if(!("ArrayBuffer"in t&&null!==t.ArrayBuffer))throw Error(f(h.UNSUPPORTED,["ArrayBuffer"]));this._trace("Paho.Client",\n    a,b,c,d,e);this.host=b;this.port=c;this.path=d;this.uri=a;this.clientId=e;this._wsuri=null;this._localKey=b+":"+c+("/mqtt"!=d?":"+d:"")+":"+e+":";this._msg_queue=[];this._buffered_msg_queue=[];this._sentMessages={};this._receivedMessages={};this._notify_msg_sent={};this._message_identifier=1;this._sequence=0;for(var g in s)0!==g.indexOf("Sent:"+this._localKey)&&0!==g.indexOf("Received:"+this._localKey)||this.restore(g)};d.prototype.host=null;d.prototype.port=null;d.prototype.path=null;d.prototype.uri=\n    null;d.prototype.clientId=null;d.prototype.socket=null;d.prototype.connected=!1;d.prototype.maxMessageIdentifier=65536;d.prototype.connectOptions=null;d.prototype.hostIndex=null;d.prototype.onConnected=null;d.prototype.onConnectionLost=null;d.prototype.onMessageDelivered=null;d.prototype.onMessageArrived=null;d.prototype.traceFunction=null;d.prototype._msg_queue=null;d.prototype._buffered_msg_queue=null;d.prototype._connectTimeout=null;d.prototype.sendPinger=null;d.prototype.receivePinger=null;d.prototype._reconnectInterval=\n    1;d.prototype._reconnecting=!1;d.prototype._reconnectTimeout=null;d.prototype.disconnectedPublishing=!1;d.prototype.disconnectedBufferSize=5E3;d.prototype.receiveBuffer=null;d.prototype._traceBuffer=null;d.prototype._MAX_TRACE_ENTRIES=100;d.prototype.connect=function(a){var b=this._traceMask(a,"password");this._trace("Client.connect",b,this.socket,this.connected);if(this.connected)throw Error(f(h.INVALID_STATE,["already connected"]));if(this.socket)throw Error(f(h.INVALID_STATE,["already connected"]));\n    this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1);this.connectOptions=a;this._reconnectInterval=1;this._reconnecting=!1;a.uris?(this.hostIndex=0,this._doConnect(a.uris[0])):this._doConnect(this.uri)};d.prototype.subscribe=function(a,b){this._trace("Client.subscribe",a,b);if(!this.connected)throw Error(f(h.INVALID_STATE,["not connected"]));var c=new p(8);c.topics=a.constructor===Array?a:[a];void 0===b.qos&&(b.qos=0);c.requestedQos=[];for(var d=\n    0;d<c.topics.length;d++)c.requestedQos[d]=b.qos;b.onSuccess&&(c.onSuccess=function(a){b.onSuccess({invocationContext:b.invocationContext,grantedQos:a})});b.onFailure&&(c.onFailure=function(a){b.onFailure({invocationContext:b.invocationContext,errorCode:a,errorMessage:f(a)})});b.timeout&&(c.timeOut=new v(this,b.timeout,b.onFailure,[{invocationContext:b.invocationContext,errorCode:h.SUBSCRIBE_TIMEOUT.code,errorMessage:f(h.SUBSCRIBE_TIMEOUT)}]));this._requires_ack(c);this._schedule_message(c)};d.prototype.unsubscribe=\n    function(a,b){this._trace("Client.unsubscribe",a,b);if(!this.connected)throw Error(f(h.INVALID_STATE,["not connected"]));var c=new p(10);c.topics=a.constructor===Array?a:[a];b.onSuccess&&(c.callback=function(){b.onSuccess({invocationContext:b.invocationContext})});b.timeout&&(c.timeOut=new v(this,b.timeout,b.onFailure,[{invocationContext:b.invocationContext,errorCode:h.UNSUBSCRIBE_TIMEOUT.code,errorMessage:f(h.UNSUBSCRIBE_TIMEOUT)}]));this._requires_ack(c);this._schedule_message(c)};d.prototype.send=\n    function(a){this._trace("Client.send",a);var b=new p(3);b.payloadMessage=a;if(this.connected)0<a.qos?this._requires_ack(b):this.onMessageDelivered&&(this._notify_msg_sent[b]=this.onMessageDelivered(b.payloadMessage)),this._schedule_message(b);else if(this._reconnecting&&this.disconnectedPublishing){if(Object.keys(this._sentMessages).length+this._buffered_msg_queue.length>this.disconnectedBufferSize)throw Error(f(h.BUFFER_FULL,[this.disconnectedBufferSize]));0<a.qos?this._requires_ack(b):(b.sequence=\n    ++this._sequence,this._buffered_msg_queue.unshift(b))}else throw Error(f(h.INVALID_STATE,["not connected"]));};d.prototype.disconnect=function(){this._trace("Client.disconnect");this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1);if(!this.socket)throw Error(f(h.INVALID_STATE,["not connecting or connected"]));var a=new p(14);this._notify_msg_sent[a]=u(this._disconnected,this);this._schedule_message(a)};d.prototype.getTraceLog=function(){if(null!==\n    this._traceBuffer){this._trace("Client.getTraceLog",new Date);this._trace("Client.getTraceLog in flight messages",this._sentMessages.length);for(var a in this._sentMessages)this._trace("_sentMessages ",a,this._sentMessages[a]);for(a in this._receivedMessages)this._trace("_receivedMessages ",a,this._receivedMessages[a]);return this._traceBuffer}};d.prototype.startTrace=function(){null===this._traceBuffer&&(this._traceBuffer=[]);this._trace("Client.startTrace",new Date,"1.1.0-2018-11-22T11:35:36Z")};d.prototype.stopTrace=\n    function(){delete this._traceBuffer};d.prototype._doConnect=function(a){this.connectOptions.useSSL&&(a=a.split(":"),a[0]="wss",a=a.join(":"));this._wsuri=a;this.connected=!1;this.socket=4>this.connectOptions.mqttVersion?new WebSocket(a,["mqttv3.1"]):new WebSocket(a,["mqtt"]);this.socket.binaryType="arraybuffer";this.socket.onopen=u(this._on_socket_open,this);this.socket.onmessage=u(this._on_socket_message,this);this.socket.onerror=u(this._on_socket_error,this);this.socket.onclose=u(this._on_socket_close,\n    this);this.sendPinger=new G(this,this.connectOptions.keepAliveInterval);this.receivePinger=new G(this,this.connectOptions.keepAliveInterval);this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null);this._connectTimeout=new v(this,this.connectOptions.timeout,this._disconnected,[h.CONNECT_TIMEOUT.code,f(h.CONNECT_TIMEOUT)])};d.prototype._schedule_message=function(a){this._msg_queue.unshift(a);this.connected&&this._process_queue()};d.prototype.store=function(a,b){var c={type:b.type,\n    messageIdentifier:b.messageIdentifier,version:1};switch(b.type){case 3:b.pubRecReceived&&(c.pubRecReceived=!0);c.payloadMessage={};for(var d="",e=b.payloadMessage.payloadBytes,g=0;g<e.length;g++)d=15>=e[g]?d+"0"+e[g].toString(16):d+e[g].toString(16);c.payloadMessage.payloadHex=d;c.payloadMessage.qos=b.payloadMessage.qos;c.payloadMessage.destinationName=b.payloadMessage.destinationName;b.payloadMessage.duplicate&&(c.payloadMessage.duplicate=!0);b.payloadMessage.retained&&(c.payloadMessage.retained=\n    !0);0===a.indexOf("Sent:")&&(void 0===b.sequence&&(b.sequence=++this._sequence),c.sequence=b.sequence);break;default:throw Error(f(h.INVALID_STORED_DATA,[a+this._localKey+b.messageIdentifier,c]));}s.setItem(a+this._localKey+b.messageIdentifier,JSON.stringify(c))};d.prototype.restore=function(a){var b=s.getItem(a),c=JSON.parse(b),d=new p(c.type,c);switch(c.type){case 3:for(var b=c.payloadMessage.payloadHex,e=new ArrayBuffer(b.length/2),e=new Uint8Array(e),g=0;2<=b.length;){var m=parseInt(b.substring(0,\n    2),16),b=b.substring(2,b.length);e[g++]=m}b=new w(e);b.qos=c.payloadMessage.qos;b.destinationName=c.payloadMessage.destinationName;c.payloadMessage.duplicate&&(b.duplicate=!0);c.payloadMessage.retained&&(b.retained=!0);d.payloadMessage=b;break;default:throw Error(f(h.INVALID_STORED_DATA,[a,b]));}0===a.indexOf("Sent:"+this._localKey)?(d.payloadMessage.duplicate=!0,this._sentMessages[d.messageIdentifier]=d):0===a.indexOf("Received:"+this._localKey)&&(this._receivedMessages[d.messageIdentifier]=d)};\n    d.prototype._process_queue=function(){for(var a=null;a=this._msg_queue.pop();)this._socket_send(a),this._notify_msg_sent[a]&&(this._notify_msg_sent[a](),delete this._notify_msg_sent[a])};d.prototype._requires_ack=function(a){var b=Object.keys(this._sentMessages).length;if(b>this.maxMessageIdentifier)throw Error("Too many messages:"+b);for(;void 0!==this._sentMessages[this._message_identifier];)this._message_identifier++;a.messageIdentifier=this._message_identifier;this._sentMessages[a.messageIdentifier]=\n    a;3===a.type&&this.store("Sent:",a);this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)};d.prototype._on_socket_open=function(){var a=new p(1,this.connectOptions);a.clientId=this.clientId;this._socket_send(a)};d.prototype._on_socket_message=function(a){this._trace("Client._on_socket_message",a.data);a=this._deframeMessages(a.data);for(var b=0;b<a.length;b+=1)this._handleMessage(a[b])};d.prototype._deframeMessages=function(a){a=new Uint8Array(a);var b=[];if(this.receiveBuffer){var c=\n    new Uint8Array(this.receiveBuffer.length+a.length);c.set(this.receiveBuffer);c.set(a,this.receiveBuffer.length);a=c;delete this.receiveBuffer}try{for(c=0;c<a.length;){var d;a:{var e=a,g=c,m=g,n=e[g],l=n>>4,z=n&15,g=g+1,x=void 0,D=0,q=1;do{if(g==e.length){d=[null,m];break a}x=e[g++];D+=(x&127)*q;q*=128}while(0!==(x&128));x=g+D;if(x>e.length)d=[null,m];else{var y=new p(l);switch(l){case 2:e[g++]&1&&(y.sessionPresent=!0);y.returnCode=e[g++];break;case 3:var m=z>>1&3,s=256*e[g]+e[g+1],g=g+2,t=F(e,g,s),\n    g=g+s;0<m&&(y.messageIdentifier=256*e[g]+e[g+1],g+=2);var r=new w(e.subarray(g,x));1==(z&1)&&(r.retained=!0);8==(z&8)&&(r.duplicate=!0);r.qos=m;r.destinationName=t;y.payloadMessage=r;break;case 4:case 5:case 6:case 7:case 11:y.messageIdentifier=256*e[g]+e[g+1];break;case 9:y.messageIdentifier=256*e[g]+e[g+1],g+=2,y.returnCode=e.subarray(g,x)}d=[y,x]}}var u=d[0],c=d[1];if(null!==u)b.push(u);else break}c<a.length&&(this.receiveBuffer=a.subarray(c))}catch(v){d="undefined"==v.hasOwnProperty("stack")?\n    v.stack.toString():"No Error Stack Available";this._disconnected(h.INTERNAL_ERROR.code,f(h.INTERNAL_ERROR,[v.message,d]));return}return b};d.prototype._handleMessage=function(a){this._trace("Client._handleMessage",a);try{switch(a.type){case 2:this._connectTimeout.cancel();this._reconnectTimeout&&this._reconnectTimeout.cancel();if(this.connectOptions.cleanSession){for(var b in this._sentMessages){var c=this._sentMessages[b];s.removeItem("Sent:"+this._localKey+c.messageIdentifier)}this._sentMessages=\n    {};for(b in this._receivedMessages){var d=this._receivedMessages[b];s.removeItem("Received:"+this._localKey+d.messageIdentifier)}this._receivedMessages={}}if(0===a.returnCode)this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length);else{this._disconnected(h.CONNACK_RETURNCODE.code,f(h.CONNACK_RETURNCODE,[a.returnCode,H[a.returnCode]]));break}a=[];for(var e in this._sentMessages)this._sentMessages.hasOwnProperty(e)&&a.push(this._sentMessages[e]);if(0<this._buffered_msg_queue.length)for(e=\n    null;e=this._buffered_msg_queue.pop();)a.push(e),this.onMessageDelivered&&(this._notify_msg_sent[e]=this.onMessageDelivered(e.payloadMessage));a=a.sort(function(a,b){return a.sequence-b.sequence});e=0;for(var g=a.length;e<g;e++)if(c=a[e],3==c.type&&c.pubRecReceived){var m=new p(6,{messageIdentifier:c.messageIdentifier});this._schedule_message(m)}else this._schedule_message(c);if(this.connectOptions.onSuccess)this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});\n    c=!1;this._reconnecting&&(c=!0,this._reconnectInterval=1,this._reconnecting=!1);this._connected(c,this._wsuri);this._process_queue();break;case 3:this._receivePublish(a);break;case 4:if(c=this._sentMessages[a.messageIdentifier])if(delete this._sentMessages[a.messageIdentifier],s.removeItem("Sent:"+this._localKey+a.messageIdentifier),this.onMessageDelivered)this.onMessageDelivered(c.payloadMessage);break;case 5:if(c=this._sentMessages[a.messageIdentifier])c.pubRecReceived=!0,m=new p(6,{messageIdentifier:a.messageIdentifier}),\n    this.store("Sent:",c),this._schedule_message(m);break;case 6:d=this._receivedMessages[a.messageIdentifier];s.removeItem("Received:"+this._localKey+a.messageIdentifier);d&&(this._receiveMessage(d),delete this._receivedMessages[a.messageIdentifier]);var n=new p(7,{messageIdentifier:a.messageIdentifier});this._schedule_message(n);break;case 7:c=this._sentMessages[a.messageIdentifier];delete this._sentMessages[a.messageIdentifier];s.removeItem("Sent:"+this._localKey+a.messageIdentifier);if(this.onMessageDelivered)this.onMessageDelivered(c.payloadMessage);\n    break;case 9:if(c=this._sentMessages[a.messageIdentifier]){c.timeOut&&c.timeOut.cancel();if(128===a.returnCode[0]){if(c.onFailure)c.onFailure(a.returnCode)}else if(c.onSuccess)c.onSuccess(a.returnCode);delete this._sentMessages[a.messageIdentifier]}break;case 11:if(c=this._sentMessages[a.messageIdentifier])c.timeOut&&c.timeOut.cancel(),c.callback&&c.callback(),delete this._sentMessages[a.messageIdentifier];break;case 13:this.sendPinger.reset();break;case 14:this._disconnected(h.INVALID_MQTT_MESSAGE_TYPE.code,\n    f(h.INVALID_MQTT_MESSAGE_TYPE,[a.type]));break;default:this._disconnected(h.INVALID_MQTT_MESSAGE_TYPE.code,f(h.INVALID_MQTT_MESSAGE_TYPE,[a.type]))}}catch(l){c="undefined"==l.hasOwnProperty("stack")?l.stack.toString():"No Error Stack Available",this._disconnected(h.INTERNAL_ERROR.code,f(h.INTERNAL_ERROR,[l.message,c]))}};d.prototype._on_socket_error=function(a){this._reconnecting||this._disconnected(h.SOCKET_ERROR.code,f(h.SOCKET_ERROR,[a.data]))};d.prototype._on_socket_close=function(){this._reconnecting||\n    this._disconnected(h.SOCKET_CLOSE.code,f(h.SOCKET_CLOSE))};d.prototype._socket_send=function(a){if(1==a.type){var b=this._traceMask(a,"password");this._trace("Client._socket_send",b)}else this._trace("Client._socket_send",a);this.socket.send(a.encode());this.sendPinger.reset()};d.prototype._receivePublish=function(a){switch(a.payloadMessage.qos){case "undefined":case 0:this._receiveMessage(a);break;case 1:var b=new p(4,{messageIdentifier:a.messageIdentifier});this._schedule_message(b);this._receiveMessage(a);\n    break;case 2:this._receivedMessages[a.messageIdentifier]=a;this.store("Received:",a);a=new p(5,{messageIdentifier:a.messageIdentifier});this._schedule_message(a);break;default:throw Error("Invaild qos\\x3d"+a.payloadMessage.qos);}};d.prototype._receiveMessage=function(a){if(this.onMessageArrived)this.onMessageArrived(a.payloadMessage)};d.prototype._connected=function(a,b){if(this.onConnected)this.onConnected(a,b)};d.prototype._reconnect=function(){this._trace("Client._reconnect");this.connected||(this._reconnecting=\n    !0,this.sendPinger.cancel(),this.receivePinger.cancel(),128>this._reconnectInterval&&(this._reconnectInterval*=2),this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri))};d.prototype._disconnected=function(a,b){this._trace("Client._disconnected",a,b);if(void 0!==a&&this._reconnecting)this._reconnectTimeout=new v(this,this._reconnectInterval,this._reconnect);else if(this.sendPinger.cancel(),this.receivePinger.cancel(),this._connectTimeout&&\n    (this._connectTimeout.cancel(),this._connectTimeout=null),this._msg_queue=[],this._buffered_msg_queue=[],this._notify_msg_sent={},this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,1===this.socket.readyState&&this.socket.close(),delete this.socket),this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1)this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex]);else if(void 0===a&&(a=h.OK.code,b=f(h.OK)),\n    this.connected){this.connected=!1;if(this.onConnectionLost)this.onConnectionLost({errorCode:a,errorMessage:b,reconnect:this.connectOptions.reconnect,uri:this._wsuri});a!==h.OK.code&&this.connectOptions.reconnect&&(this._reconnectInterval=1,this._reconnect())}else if(4===this.connectOptions.mqttVersion&&!1===this.connectOptions.mqttVersionExplicit)this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):\n    this._doConnect(this.uri);else if(this.connectOptions.onFailure)this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:a,errorMessage:b})};d.prototype._trace=function(){if(this.traceFunction){var a=Array.prototype.slice.call(arguments),b;for(b in a)"undefined"!==typeof a[b]&&a.splice(b,1,JSON.stringify(a[b]));b=a.join("");this.traceFunction({severity:"Debug",message:b})}if(null!==this._traceBuffer)for(b=0,a=arguments.length;b<a;b++)this._traceBuffer.length==\n    this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),0===b?this._traceBuffer.push(arguments[b]):"undefined"===typeof arguments[b]?this._traceBuffer.push(arguments[b]):this._traceBuffer.push("  "+JSON.stringify(arguments[b]))};d.prototype._traceMask=function(a,b){var c={},d;for(d in a)a.hasOwnProperty(d)&&(c[d]=d==b?"******":a[d]);return c};var w=function(a){var b;if("string"===typeof a||a instanceof ArrayBuffer||ArrayBuffer.isView(a)&&!(a instanceof DataView))b=a;else throw f(h.INVALID_ARGUMENT,[a,\n    "newPayload"]);var c,d=0,e=!1,g=!1;Object.defineProperties(this,{payloadString:{enumerable:!0,get:function(){return"string"===typeof b?b:F(b,0,b.length)}},payloadBytes:{enumerable:!0,get:function(){if("string"===typeof b){var a=new ArrayBuffer(n(b)),a=new Uint8Array(a);E(b,a,0);return a}return b}},destinationName:{enumerable:!0,get:function(){return c},set:function(a){if("string"===typeof a)c=a;else throw Error(f(h.INVALID_ARGUMENT,[a,"newDestinationName"]));}},qos:{enumerable:!0,get:function(){return d},\n    set:function(a){if(0===a||1===a||2===a)d=a;else throw Error("Invalid argument:"+a);}},retained:{enumerable:!0,get:function(){return e},set:function(a){if("boolean"===typeof a)e=a;else throw Error(f(h.INVALID_ARGUMENT,[a,"newRetained"]));}},topic:{enumerable:!0,get:function(){return c},set:function(a){c=a}},duplicate:{enumerable:!0,get:function(){return g},set:function(a){g=a}}})};return{Client:function(a,b,c,k){var e;if("string"!==typeof a)throw Error(f(h.INVALID_TYPE,[typeof a,"host"]));if(2==arguments.length){k=\n    b;e=a;var g=e.match(/^(wss?):\\/\\/((\\[(.+)\\])|([^\\/]+?))(:(\\d+))?(\\/.*)$/);if(g)a=g[4]||g[2],b=parseInt(g[7]),c=g[8];else throw Error(f(h.INVALID_ARGUMENT,[a,"host"]));}else{3==arguments.length&&(k=c,c="/mqtt");if("number"!==typeof b||0>b)throw Error(f(h.INVALID_TYPE,[typeof b,"port"]));if("string"!==typeof c)throw Error(f(h.INVALID_TYPE,[typeof c,"path"]));e="ws://"+(-1!==a.indexOf(":")&&"["!==a.slice(0,1)&&"]"!==a.slice(-1)?"["+a+"]":a)+":"+b+c}for(var m=g=0;m<k.length;m++){var n=k.charCodeAt(m);\n    55296<=n&&56319>=n&&m++;g++}if("string"!==typeof k||65535<g)throw Error(f(h.INVALID_ARGUMENT,[k,"clientId"]));var l=new d(e,a,b,c,k);Object.defineProperties(this,{host:{get:function(){return a},set:function(){throw Error(f(h.UNSUPPORTED_OPERATION));}},port:{get:function(){return b},set:function(){throw Error(f(h.UNSUPPORTED_OPERATION));}},path:{get:function(){return c},set:function(){throw Error(f(h.UNSUPPORTED_OPERATION));}},uri:{get:function(){return e},set:function(){throw Error(f(h.UNSUPPORTED_OPERATION));\n    }},clientId:{get:function(){return l.clientId},set:function(){throw Error(f(h.UNSUPPORTED_OPERATION));}},onConnected:{get:function(){return l.onConnected},set:function(a){if("function"===typeof a)l.onConnected=a;else throw Error(f(h.INVALID_TYPE,[typeof a,"onConnected"]));}},disconnectedPublishing:{get:function(){return l.disconnectedPublishing},set:function(a){l.disconnectedPublishing=a}},disconnectedBufferSize:{get:function(){return l.disconnectedBufferSize},set:function(a){l.disconnectedBufferSize=\n    a}},onConnectionLost:{get:function(){return l.onConnectionLost},set:function(a){if("function"===typeof a)l.onConnectionLost=a;else throw Error(f(h.INVALID_TYPE,[typeof a,"onConnectionLost"]));}},onMessageDelivered:{get:function(){return l.onMessageDelivered},set:function(a){if("function"===typeof a)l.onMessageDelivered=a;else throw Error(f(h.INVALID_TYPE,[typeof a,"onMessageDelivered"]));}},onMessageArrived:{get:function(){return l.onMessageArrived},set:function(a){if("function"===typeof a)l.onMessageArrived=\n    a;else throw Error(f(h.INVALID_TYPE,[typeof a,"onMessageArrived"]));}},trace:{get:function(){return l.traceFunction},set:function(a){if("function"===typeof a)l.traceFunction=a;else throw Error(f(h.INVALID_TYPE,[typeof a,"onTrace"]));}}});this.connect=function(a){a=a||{};A(a,{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",\n    ports:"object",reconnect:"boolean",mqttVersion:"number",mqttVersionExplicit:"boolean",uris:"object"});void 0===a.keepAliveInterval&&(a.keepAliveInterval=60);if(4<a.mqttVersion||3>a.mqttVersion)throw Error(f(h.INVALID_ARGUMENT,[a.mqttVersion,"connectOptions.mqttVersion"]));void 0===a.mqttVersion?(a.mqttVersionExplicit=!1,a.mqttVersion=4):a.mqttVersionExplicit=!0;if(void 0!==a.password&&void 0===a.userName)throw Error(f(h.INVALID_ARGUMENT,[a.password,"connectOptions.password"]));if(a.willMessage){if(!(a.willMessage instanceof\n    w))throw Error(f(h.INVALID_TYPE,[a.willMessage,"connectOptions.willMessage"]));a.willMessage.stringPayload=null;if("undefined"===typeof a.willMessage.destinationName)throw Error(f(h.INVALID_TYPE,[typeof a.willMessage.destinationName,"connectOptions.willMessage.destinationName"]));}"undefined"===typeof a.cleanSession&&(a.cleanSession=!0);if(a.hosts){if(!(a.hosts instanceof Array))throw Error(f(h.INVALID_ARGUMENT,[a.hosts,"connectOptions.hosts"]));if(1>a.hosts.length)throw Error(f(h.INVALID_ARGUMENT,\n    [a.hosts,"connectOptions.hosts"]));for(var b=!1,d=0;d<a.hosts.length;d++){if("string"!==typeof a.hosts[d])throw Error(f(h.INVALID_TYPE,[typeof a.hosts[d],"connectOptions.hosts["+d+"]"]));if(/^(wss?):\\/\\/((\\[(.+)\\])|([^\\/]+?))(:(\\d+))?(\\/.*)$/.test(a.hosts[d]))if(0===d)b=!0;else{if(!b)throw Error(f(h.INVALID_ARGUMENT,[a.hosts[d],"connectOptions.hosts["+d+"]"]));}else if(b)throw Error(f(h.INVALID_ARGUMENT,[a.hosts[d],"connectOptions.hosts["+d+"]"]));}if(b)a.uris=a.hosts;else{if(!a.ports)throw Error(f(h.INVALID_ARGUMENT,\n    [a.ports,"connectOptions.ports"]));if(!(a.ports instanceof Array))throw Error(f(h.INVALID_ARGUMENT,[a.ports,"connectOptions.ports"]));if(a.hosts.length!==a.ports.length)throw Error(f(h.INVALID_ARGUMENT,[a.ports,"connectOptions.ports"]));a.uris=[];for(d=0;d<a.hosts.length;d++){if("number"!==typeof a.ports[d]||0>a.ports[d])throw Error(f(h.INVALID_TYPE,[typeof a.ports[d],"connectOptions.ports["+d+"]"]));var b=a.hosts[d],g=a.ports[d];e="ws://"+(-1!==b.indexOf(":")?"["+b+"]":b)+":"+g+c;a.uris.push(e)}}}l.connect(a)};\n    this.subscribe=function(a,b){if("string"!==typeof a&&a.constructor!==Array)throw Error("Invalid argument:"+a);b=b||{};A(b,{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"});if(b.timeout&&!b.onFailure)throw Error("subscribeOptions.timeout specified with no onFailure callback.");if("undefined"!==typeof b.qos&&0!==b.qos&&1!==b.qos&&2!==b.qos)throw Error(f(h.INVALID_ARGUMENT,[b.qos,"subscribeOptions.qos"]));l.subscribe(a,b)};this.unsubscribe=function(a,\n    b){if("string"!==typeof a&&a.constructor!==Array)throw Error("Invalid argument:"+a);b=b||{};A(b,{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"});if(b.timeout&&!b.onFailure)throw Error("unsubscribeOptions.timeout specified with no onFailure callback.");l.unsubscribe(a,b)};this.send=function(a,b,c,d){var e;if(0===arguments.length)throw Error("Invalid argument.length");if(1==arguments.length){if(!(a instanceof w)&&"string"!==typeof a)throw Error("Invalid argument:"+\n    typeof a);e=a;if("undefined"===typeof e.destinationName)throw Error(f(h.INVALID_ARGUMENT,[e.destinationName,"Message.destinationName"]));}else e=new w(b),e.destinationName=a,3<=arguments.length&&(e.qos=c),4<=arguments.length&&(e.retained=d);l.send(e)};this.publish=function(a,b,c,d){var e;if(0===arguments.length)throw Error("Invalid argument.length");if(1==arguments.length){if(!(a instanceof w)&&"string"!==typeof a)throw Error("Invalid argument:"+typeof a);e=a;if("undefined"===typeof e.destinationName)throw Error(f(h.INVALID_ARGUMENT,\n    [e.destinationName,"Message.destinationName"]));}else e=new w(b),e.destinationName=a,3<=arguments.length&&(e.qos=c),4<=arguments.length&&(e.retained=d);l.send(e)};this.disconnect=function(){l.disconnect()};this.getTraceLog=function(){return l.getTraceLog()};this.startTrace=function(){l.startTrace()};this.stopTrace=function(){l.stopTrace()};this.isConnected=function(){return l.connected}},Message:w}}("undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:\n    {})});\nfunction _clspRouter() {\n    function send(m){\n        // route message to parent which will in turn route to the correct\n        // player based on clientId.\n        m.clientId = MqttClientId;\n        // console.log(m);\n        window.parent.postMessage(m,"*");\n    }// end send\n\n\n    function routeInbound(message){\n        var pstring = "";\n\n        try {\n            pstring = message.payloadString;\n        } catch(e) {\n            //bogus excepton?\n        }\n\n        send({\n          event: \'data\',\n          destinationName: message.destinationName,\n          payloadString: pstring,\n          payloadBytes: message.payloadBytes || null\n        });\n    }// end route inbound\n\n\n    function eventHandler(evt){\n        var m = evt.data;\n\n        try {\n            if (m.method === \'subscribe\') {\n                MQTTClient.subscribe(m.topic);\n            } else if (m.method === \'unsubscribe\') {\n                MQTTClient.unsubscribe(m.topic);\n            } else if (m.method === \'publish\') {\n                var mqtt_payload = null;\n                try {\n                    mqtt_payload = JSON.stringify(m.data);\n                } catch( json_error ) {\n                    console.error("json stringify error: " + m.data);\n                    return;\n                }\n\n                var mqtt_msg = new Paho.MQTT.Message(mqtt_payload);\n                mqtt_msg.destinationName = m.topic;\n                MQTTClient.send(mqtt_msg);\n            }\n        } catch(e) {\n            // we are dead!\n           send({\n               event: \'fail\',\n               reason: "network failure"\n            });\n            try {\n                MQTTClient.disconnect();\n            } catch(e) {\n                console.error(e);\n            }\n        }\n\n    }\n\n    function AppReady() {\n\n        if (window.addEventListener) {\n            window.addEventListener("message", eventHandler, false);\n        } else if (window.attachEvent) {\n            window.attachEvent(\'onmessage\', eventHandler);\n        }\n\n        send({\n          event: \'ready\'\n        });\n\n        if (Reconnect !== -1)\n        {\n            clearInterval(Reconnect);\n            Reconnect = -1;\n        }\n\n    }// application ready\n\n\n    function AppFail(message) {\n      var e = "Error code " +\n          parseInt(message.errorCode) + ": " + message.errorMessage;\n      send({\n        event: \'fail\',\n        reason: e\n      });\n    }\n\n    MQTTClient = new Paho.MQTT.Client(\n        MqttIp,\n        MqttPort,\n        MqttClientId\n    );\n\n    /*\n     * Hold the id of the reconnect interval task\n     */\n    var Reconnect = -1;\n\n    /*\n     * Callback which gets called when the connection is lost\n     */\n    function onConnectionLost(message){\n        send({\n            event: \'fail\',\n            reason: "connection lost error code " + parseInt(message.errorCode)\n        });\n        if (Reconnect === -1) {\n            Reconnect = setInterval(() => connect(), 2000);\n        }\n    }\n\n    MQTTClient.onConnectionLost = onConnectionLost;\n\n    // perhaps the busiest function in this module ;)\n    MQTTClient.onMessageArrived = function(message) {\n        // console.log(message);\n        try {\n             routeInbound(message);\n        }catch(e) {\n            if (e) {\n                console.error(e);\n            }\n        }\n    };\n\n    /**\n     * Connect to MQTT...\n     */\n    function connect()\n    {\n        // setup connection options\n        var options = {\n            timeout: 120,\n            onSuccess:  AppReady,\n            onFailure: AppFail\n        };\n        // last will message sent on disconnect\n        var willmsg = new Paho.MQTT.Message(JSON.stringify({\n            clientId: MqttClientId\n        }));\n        willmsg.destinationName = "iov/clientDisconnect";\n        options.willMessage = willmsg;\n\n        if (MqttUseSSL === true) {\n            options.useSSL = true;\n        }\n\n        try {\n            MQTTClient.connect(options);\n        } catch(e) {\n            console.error("connect failed", e);\n            send({\n                event: \'fail\',\n                reason: "connect failed"\n            });\n        }\n    }\n\n    connect();\n}\n\nfunction clspRouter() {\n    try {\n        _clspRouter();\n    } catch(e) {\n        console.error("IFRAME error");\n        console.error(e);\n    }\n}\n\nfunction onunload()\n{\n    if (typeof MQTTClient !== \'undefined\') {\n        MQTTClient.disconnect();\n    }\n}\n\n<\/script>\n</head><body onload="clspRouter();" onunload="onunload();"><body><div id="message"></div></body></html>';if(t.srcdoc=o,t.width=0,t.height=0,t.setAttribute("style","display:none;"),t.setAttribute("id",e.config.clientId),null!==e.config.videoElementParent)e.config.videoElementParent.appendChild(t);else if(null!==e.videoElement.parentNode)e.videoElement.parentNode.appendChild(t),e.config.videoElementParent=e.videoElement.parentNode;else var r=setInterval(function(){null!==e.videoElement.parentNode&&(e.videoElement.parentNode.appendChild(t),e.config.videoElementParent=e.videoElement.parentNode,clearInterval(r))},1e3);return function(e,t){var n={dispatch:{},iov:t};function o(t){if(null===e.contentWindow)var n=setInterval(function(){null!==e.contentWindow&&(e.contentWindow.postMessage(t,"*"),clearInterval(n))},1e3);else e.contentWindow.postMessage(t,"*")}return n.inboundHandler=function(e){var t=n.dispatch[e.destinationName];if("undefined"!==typeof t)try{t(e)}catch(e){console.error(e)}else console.error("No handler for "+e.destinationName)},n.subscribe=function(e,t){n.dispatch[e]=t,o({method:"subscribe",topic:e})},n.unsubscribe=function(e){e in n.dispatch&&delete n.dispatch[e],o({method:"unsubscribe",topic:e})},n.publish=function(e,t){o({method:"publish",topic:e,data:t})},n.transaction=function(e,o,r){r.resp_topic=t.config.clientId+"/response/"+parseInt(1e6*Math.random()),n.subscribe(r.resp_topic,function(e){var t=JSON.parse(e.payloadString);o(t),n.unsubscribe(r.resp_topic)}),n.publish(e,r)},n}(t,e)}},"./src/js/iov/IOV.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/debug/src/browser.js"),r=n.n(o),s=n("./node_modules/uuid/v4.js"),i=n.n(s),a=n("./src/js/iov/MqttTopicHandlers.js"),c=n("./src/js/iov/player.js"),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var l="skyline:clsp:iov",f=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.compatibilityCheck(),this.id=i()(),this.debug=r()(l+":"+this.id+":main"),this.debug("constructor"),this.destroyed=!1,this.onReadyAlreadyCalled=!1,this.playerInstance=n,this.videoElement=this.playerInstance.el(),this.config={clientId:this.id,wsbroker:o.wsbroker,wsport:o.wsport,useSSL:o.useSSL,streamName:o.streamName,appStart:o.appStart,videoElementParent:o.videoElementParent||null,changeSourceMaxWait:o.changeSourceMaxWait||e.CHANGE_SOURCE_MAX_WAIT},this.statsMsg={byteCount:0,inkbps:0,host:document.location.host,clientId:this.config.clientId},this.mqttConduitCollection=t,this.mqttTopicHandlers=new a.default(this.id,this),this.events={connection_lost:function(e){console.error("MQTT connection lost"),console.error(e)},on_message:this.mqttTopicHandlers.msghandler,exception:function(e,t){console.error(e),"undefined"!==typeof t&&console.error(t.stack)}}}return d(e,null,[{key:"compatibilityCheck",value:function(){var e=!1;window.MediaSource=window.MediaSource||window.WebKitMediaSource,window.MediaSource||(!1===e&&window.alert("Media Source Extensions not supported in your browser: Claris Live Streaming will not work!"),e=!0)}},{key:"generateConfigFromUrl",value:function(e){if(!e)throw new Error("No source was given to be parsed!");var t=document.createElement("a"),n=void 0,o=void 0;if("clsps"===e.substring(0,5).toLowerCase())n=!0,t.href=e.replace("clsps","https"),o=443;else{if("clsp"!==e.substring(0,4).toLowerCase())throw new Error("The given source is not a clsp url, and therefore cannot be parsed.");n=!1,t.href=e.replace("clsp","http"),o=9001}var r=t.pathname.split("/"),s=r[r.length-1],i=t.hostname,a=t.port;return 0===a.length&&(a=o),"@"===i&&(i=window.location.hostname),{wsbroker:i,wsport:parseInt(a),streamName:s,useSSL:n}}},{key:"factory",value:function(t,n){return new e(t,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}},{key:"fromUrl",value:function(t,n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return e.factory(n,o,u({},r,e.generateConfigFromUrl(t)))}}]),d(e,[{key:"initialize",value:function(){this.conduit=this.mqttConduitCollection.addFromIov(this),this.player=c.default.factory(this,this.playerInstance)}},{key:"clone",value:function(t){this.debug("clone");var n=u({},t,{videoElementParent:this.config.videoElementParent});return e.factory(this.mqttConduitCollection,this.playerInstance,n)}},{key:"cloneFromUrl",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.debug("cloneFromUrl"),this.clone(u({},e.generateConfigFromUrl(t),n))}},{key:"getAvailableStreams",value:function(e){this.debug("getAvailableStreams"),this.conduit.transaction("iov/video/list",e,{})}},{key:"onChangeSource",value:function(e){if(this.debug('changeSource on player "'+this.id+'""'),!e)throw new Error("Unable to change source because there is no url!");var t=this.cloneFromUrl(e);t.initialize(),setTimeout(function(){t.playerInstance.tech(!0).mqtt.updateIOV(t)},t.config.changeSourceMaxWait),t.player.on("firstFrameShown",function(){t.playerInstance.tech(!0).mqtt.updateIOV(t)})}},{key:"onReady",value:function(e){var t=this;this.debug("onReady"),null!==this.videoElement.parentNode&&(this.config.videoElementParentId=this.videoElement.parentNode.id);var n=this.playerInstance.children()[0];null!==n.getAttribute("autoplay")&&this.playerInstance.trigger("play",n),this.onReadyAlreadyCalled?console.warn("tried to use this player more than once..."):(this.onReadyAlreadyCalled=!0,this.player.on("firstFrameShown",function(){t.playerInstance.loadingSpinner.hide(),n.style.display="none"}),this.player.on("videoReceived",function(){t.playerInstance.trigger("timeupdate")}),this.player.on("videoInfoReceived",function(){t.playerInstance.trigger("timeupdate")}),this.playerInstanceEventListeners={changesrc:function(e,n){var o=n.url;return t.onChangeSource(o)}},this.playerInstance.on("changesrc",this.playerInstanceEventListeners.changesrc),this.player.play(this.videoElement.firstChild.id,this.config.streamName),this.videoElement.addEventListener("mse-error-event",function(e){t.player.restart()},!1),this._statsTimer=setInterval(function(){t.statsMsg.inkbps=8*t.statsMsg.byteCount/3e4,t.statsMsg.byteCount=0,t.conduit.publish("iov/stats",t.statsMsg),t.debug("iov status",t.statsMsg)},5e3))}},{key:"onFail",value:function(e){this.debug("onFail"),this.debug("network error",e.data.reason),this.playerInstance.trigger("network-error",e.data.reason)}},{key:"onData",value:function(e){this.debug("onData"),this.conduit.inboundHandler(e.data)}},{key:"onMessage",value:function(e){var t=e.data.event;switch(this.debug("onMessage",t),t){case"ready":this.onReady(e);break;case"fail":this.onFail(e);break;case"data":this.onData(e);break;default:console.error("No match for event: "+t)}}},{key:"destroy",value:function(){if(this.debug("destroy"),!this.destroyed){this.destroyed=!0,clearInterval(this._statsTimer),this.conduit.unsubscribe("iov/video/"+this.player.guid+"/live"),this.playerInstance.off("changesrc",this.playerInstanceEventListeners.changesrc),this.player.destroy(),this.playerInstance=null,this.player=null,this.mqttConduitCollection.remove(this.id);var e=document.getElementById(this.config.clientId);e.parentNode.removeChild(e),e.srcdoc=""}}}]),e}();f.CHANGE_SOURCE_MAX_WAIT=5e3,t.default=f},"./src/js/iov/MSEWrapper.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/debug/src/browser.js"),r=n.n(o),s=n("./node_modules/lodash/defaults.js"),i=n.n(s),a=n("./node_modules/lodash/noop.js"),c=n.n(a),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function d(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function o(r,s){try{var i=t[r](s),a=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(a).then(function(e){o("next",e)},function(e){o("throw",e)});e(a)}("next")})}}var l=r()("skyline:clsp:iov:MSEWrapper"),f=r()("silly:skyline:clsp:iov:MSEWrapper"),h=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l("Constructing..."),!t)throw new Error("videoElement is required to construct an MSEWrapper.");this.destroyed=!1,this.videoElement=t,this.options=i()({},n,{bufferSizeLimit:90+Math.floor(200*Math.random()),bufferTruncateFactor:2,bufferTruncateValue:null,driftThreshold:2e3,duration:10,enableMetrics:!0}),this.segmentQueue=[],this.sequenceNumber=0,this.mediaSource=null,this.sourceBuffer=null,this.objectURL=null,this.timeBuffered=null,this.options.bufferTruncateValue||(this.options.bufferTruncateValue=parseInt(this.options.bufferSizeLimit/this.options.bufferTruncateFactor)),this.metrics={},this.events={};for(var o=0;o<e.EVENT_NAMES.length;o++)this.events[e.EVENT_NAMES[o]]=[];this.eventListeners={mediaSource:{},sourceBuffer:{}},this.onSourceBufferUpdateEnd=this.onSourceBufferUpdateEnd.bind(this)}return u(e,null,[{key:"isMimeCodecSupported",value:function(e){return window.MediaSource&&window.MediaSource.isTypeSupported(e)}},{key:"factory",value:function(t){return new e(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}}]),u(e,[{key:"on",value:function(t,n){if(l("Registering Listener for "+t+" event..."),!e.EVENT_NAMES.includes(t))throw new Error('"'+t+'" is not a valid event."');this.events[t].push(n)}},{key:"trigger",value:function(t,n){if("metric"===t?f("Triggering "+t+" event..."):l("Triggering "+t+" event..."),!e.EVENT_NAMES.includes(t))throw new Error('"'+t+'" is not a valid event."');for(var o=0;o<this.events[t].length;o++)this.events[t][o](n,this)}},{key:"metric",value:function(t,n){if(this.options&&this.options.enableMetrics&&e.METRIC_TYPES.includes(t)){switch(t){case"sourceBuffer.lastKnownBufferSize":case"sourceBuffer.lastMoofSize":this.metrics[t]=n;break;default:this.metrics.hasOwnProperty(t)||(this.metrics[t]=0),this.metrics[t]+=n}this.trigger("metric",{type:t,value:this.metrics[t]})}}},{key:"initializeMediaSource",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l("Initializing mediaSource..."),t=i()({},t,{onSourceOpen:c.a,onSourceEnded:c.a,onError:c.a}),this.metric("mediaSource.created",1),this.destroyMediaSource(),this.mediaSource=new window.MediaSource,this.eventListeners.mediaSource.sourceopen=function(){e.mediaSource.duration=e.options.duration,t.onSourceOpen()},this.eventListeners.mediaSource.sourceended=t.onSourceEnded,this.eventListeners.mediaSource.error=t.onError,this.mediaSource.addEventListener("sourceopen",this.eventListeners.mediaSource.sourceopen),this.mediaSource.addEventListener("sourceended",this.eventListeners.mediaSource.sourceended),this.mediaSource.addEventListener("error",this.eventListeners.mediaSource.error)}},{key:"getVideoElementSrc",value:function(){l("getVideoElementSrc..."),this.mediaSource&&(this.objectURL||(this.metric("objectURL.created",1),this.objectURL=window.URL.createObjectURL(this.mediaSource)),this.videoElement.src=this.objectURL)}},{key:"destroyVideoElementSrc",value:function(){if(l("destroyVideoElementSrc..."),this.mediaSource&&this.objectURL)return this.objectURL=null,this.sourceBuffer&&this.sourceBufferAbort(),window.URL.revokeObjectURL(this.videoElement.src)}},{key:"reinitializeVideoElementSrc",value:function(){return this.metric("mediaSource.reinitialized",1),this.destroyVideoElementSrc(),this.getVideoElementSrc()}},{key:"isMediaSourceReady",value:function(){return this.mediaSource&&"open"===this.mediaSource.readyState}},{key:"isSourceBufferReady",value:function(){return this.sourceBuffer&&!1===this.sourceBuffer.updating}},{key:"initializeSourceBuffer",value:function(){var e=d(regeneratorRuntime.mark(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l("initializeSourceBuffer..."),n=i()({},n,{onAppendStart:c.a,onAppendFinish:c.a,onRemoveFinish:c.a,onAppendError:c.a,onRemoveError:c.a,onStreamFrozen:c.a,onError:c.a,retry:!0}),this.isMediaSourceReady()){e.next=4;break}throw new Error("Cannot create the sourceBuffer if the mediaSource is not ready.");case 4:return e.next=6,this.destroySourceBuffer();case 6:this.metric("sourceBuffer.created",1),this.sourceBuffer=this.mediaSource.addSourceBuffer(t),this.sourceBuffer.mode="sequence",this.eventListeners.sourceBuffer.onAppendStart=n.onAppendStart,this.eventListeners.sourceBuffer.onAppendError=n.onAppendError,this.eventListeners.sourceBuffer.onRemoveFinish=n.onRemoveFinish,this.eventListeners.sourceBuffer.onAppendFinish=n.onAppendFinish,this.eventListeners.sourceBuffer.onRemoveError=n.onRemoveError,this.eventListeners.sourceBuffer.onStreamFrozen=n.onStreamFrozen,this.eventListeners.sourceBuffer.onError=n.onError,this.sourceBuffer.addEventListener("updateend",this.onSourceBufferUpdateEnd),this.sourceBuffer.addEventListener("error",this.eventListeners.sourceBuffer.onError);case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"queueSegment",value:function(e){l("Queueing segment.  The queue now has "+this.segmentQueue.length+" segments."),this.metric("queue.added",1),this.segmentQueue.push({timestamp:Date.now(),byteArray:e})}},{key:"sourceBufferAbort",value:function(){l("Aborting current sourceBuffer operation");try{this.metric("sourceBuffer.abort",1),this.sourceBuffer.abort()}catch(e){this.metric("error.sourceBuffer.abort",1),this.eventListeners.sourceBuffer.onAbortError&&this.eventListeners.sourceBuffer.onAbortError(e)}}},{key:"_append",value:function(e){var t=e.timestamp,n=e.byteArray;f("Appending to the sourceBuffer...");try{var o=Date.now()-t;if(o>this.options.driftThreshold)return l("Estimated drift of "+o+" is above the "+this.options.driftThreshold+" threshold.  Flushing queue..."),this.metric("queue.removed",this.segmentQueue.length+1),void(this.segmentQueue=[]);l("Appending to the buffer with an estimated drift of "+o),this.metric("sourceBuffer.append",1),this.sourceBuffer.appendBuffer(n)}catch(e){this.metric("error.sourceBuffer.append",1),this.eventListeners.sourceBuffer.onAppendError(e,n)}}},{key:"processNextInQueue",value:function(){return f("processNextInQueue"),"hidden"===document.visibilityState?(l("Tab not in focus - dropping frame..."),this.metric("frameDrop.hiddenTab",1),void this.metric("queue.cannotProcessNext",1)):this.isMediaSourceReady()?this.isSourceBufferReady()?void(this.segmentQueue.length>0&&(this.metric("queue.shift",1),this.metric("queue.canProcessNext",1),this._append(this.segmentQueue.shift()))):(l("The sourceBuffer is busy"),this.metric("queue.sourceBufferNotReady",1),void this.metric("queue.cannotProcessNext",1)):(l("The mediaSource is not ready"),this.metric("queue.mediaSourceNotReady",1),void this.metric("queue.cannotProcessNext",1))}},{key:"formatMoof",value:function(e){return e[20]=(4278190080&this.sequenceNumber)>>24,e[21]=(16711680&this.sequenceNumber)>>16,e[22]=(65280&this.sequenceNumber)>>8,e[23]=255&this.sequenceNumber,e}},{key:"appendMoov",value:function(e){l("appendMoov"),this.metric("sourceBuffer.lastMoovSize",e.length),this.eventListeners.sourceBuffer.onAppendStart&&(l("appending moov..."),this.queueSegment(e),this.processNextInQueue())}},{key:"append",value:function(e){f("Append"),this.metric("sourceBuffer.lastMoofSize",e.length),this.eventListeners.sourceBuffer.onAppendStart&&(this.eventListeners.sourceBuffer.onAppendStart(e),this.metric("queue.append",1),this.queueSegment(this.formatMoof(e)),this.sequenceNumber++,this.processNextInQueue())}},{key:"getBufferTimes",value:function(){var e=this.timeBuffered,t=this.sourceBuffer.buffered.start(0),n=this.sourceBuffer.buffered.end(0);return{previousBufferSize:e,currentBufferSize:n-t,bufferTimeStart:t,bufferTimeEnd:n}}},{key:"trimBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.metric("sourceBuffer.lastKnownBufferSize",this.timeBuffered);try{e||(e=this.getBufferTimes()),(t||this.timeBuffered>this.options.bufferSizeLimit&&this.isSourceBufferReady())&&(l("Removing old stuff from sourceBuffer..."),this.metric("sourceBuffer.trim",this.options.bufferTruncateValue),this.sourceBuffer.remove(e.bufferTimeStart,e.bufferTimeStart+this.options.bufferTruncateValue))}catch(e){this.metric("sourceBuffer.trim.error",1),this.eventListeners.sourceBuffer.onRemoveError(e)}}},{key:"onRemoveFinish",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getBufferTimes();l("On remove finish..."),this.metric("sourceBuffer.updateEnd.removeEvent",1),this.eventListeners.sourceBuffer.onRemoveFinish(e)}},{key:"onAppendFinish",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getBufferTimes();if(f("On append finish..."),this.metric("sourceBuffer.updateEnd.appendEvent",1),this.previousTimeEnd&&e.bufferTimeEnd<=this.previousTimeEnd)return this.metric("sourceBuffer.updateEnd.bufferFrozen",1),void this.eventListeners.sourceBuffer.onStreamFrozen();this.previousTimeEnd=e.bufferTimeEnd,this.eventListeners.sourceBuffer.onAppendFinish(e),this.trimBuffer(e)}},{key:"onSourceBufferUpdateEnd",value:function(){f("onUpdateEnd"),this.metric("sourceBuffer.updateEnd",1);try{if(this.sourceBuffer.buffered.length<=0)return this.metric("sourceBuffer.updateEnd.bufferLength.empty",1),void l("After updating, the sourceBuffer has no length!")}catch(e){return this.metric("sourceBuffer.updateEnd.bufferLength.error",1),void l("The mediaSource was removed while an update operation was occurring.")}var e=this.getBufferTimes();this.timeBuffered=e.currentBufferSize,null!==e.previousBufferSize&&e.previousBufferSize>this.timeBuffered?this.onRemoveFinish(e):this.onAppendFinish(e),this.processNextInQueue()}},{key:"destroySourceBuffer",value:function(){var e=this;return new Promise(function(t,n){if(!e.sourceBuffer)return t();e.sourceBufferAbort(),e.sourceBuffer.removeEventListener("updateend",e.onSourceBufferUpdateEnd),e.sourceBuffer.removeEventListener("error",e.eventListeners.sourceBuffer.onError),e.sourceBuffer.addEventListener("updateend",function(){t()}),e.trimBuffer(void 0,!0)})}},{key:"destroyMediaSource",value:function(){this.metric("sourceBuffer.destroyed",1),l("Destroying mediaSource..."),this.mediaSource&&(this.mediaSource.removeEventListener("sourceopen",this.eventListeners.mediaSource.sourceopen),this.mediaSource.removeEventListener("sourceended",this.eventListeners.mediaSource.sourceended),this.mediaSource.removeEventListener("error",this.eventListeners.mediaSource.error),this.isMediaSourceReady()&&this.mediaSource.endOfStream(),this.mediaSource.removeSourceBuffer(this.sourceBuffer),this.destroyVideoElementSrc(),this.metric("mediaSource.destroyed",1))}},{key:"destroy",value:function(){var e=d(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l("destroySourceBuffer..."),!this.destroyed){e.next=3;break}return e.abrupt("return");case 3:return this.destroyed=!0,this.destroyMediaSource(),e.next=7,this.destroySourceBuffer();case 7:this.mediaSource=null,this.sourceBuffer=null,this.videoElement=null,this.timeBuffered=null,this.previousTimeEnd=null,this.segmentQueue=null,this.options=null,this.metrics=null,this.events=null,this.eventListeners=null,this.onSourceBufferUpdateEnd=null;case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();h.EVENT_NAMES=["metric"],h.METRIC_TYPES=["mediaSource.created","mediaSource.destroyed","objectURL.created","objectURL.revoked","mediaSource.reinitialized","sourceBuffer.created","sourceBuffer.destroyed","queue.added","queue.removed","sourceBuffer.append","error.sourceBuffer.append","frameDrop.hiddenTab","queue.mediaSourceNotReady","queue.sourceBufferNotReady","queue.shift","queue.append","sourceBuffer.lastKnownBufferSize","sourceBuffer.trim","sourceBuffer.trim.error","sourceBuffer.updateEnd","sourceBuffer.updateEnd.bufferLength.empty","sourceBuffer.updateEnd.bufferLength.error","sourceBuffer.updateEnd.removeEvent","sourceBuffer.updateEnd.appendEvent","sourceBuffer.updateEnd.bufferFrozen","sourceBuffer.abort","error.sourceBuffer.abort","sourceBuffer.lastMoofSize"],t.default=h},"./src/js/iov/MqttTopicHandlers.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/debug/src/browser.js"),r=n.n(o),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i="skyline:clsp:iov",a=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.debug=r()(i+":"+this.id+":MqttTopicHandlers"),this.debug("constructing..."),this.iov=n,this._handlers={}}return s(e,[{key:"get",value:function(e){return this.debug("getting...",e),this._handlers[e]}},{key:"register",value:function(e,t){var n=this;this.debug("register...",e),this._handlers[e]=function(){n.debug("executing handler...",e),t.apply(void 0,arguments)}}},{key:"unregister",value:function(e){this.debug("unregistering...",e),this.exists(e)&&delete this._handlers[e]}},{key:"exists",value:function(e){return this.debug("exists?",e),this._handlers.hasOwnProperty(e)}},{key:"msghandler",value:function(e){this.debug("msghandler...",e);var t=e.destinationName;if(this.exists(t))try{this.get(t)(e)}catch(e){this.iov.events.exception(t+" handler exception",e)}else this.debug("No handler for "+t+" - message dropped",e)}}]),e}();t.default=a},"./src/js/iov/player.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/debug/src/browser.js"),r=n.n(o),s=n("./node_modules/uuid/v4.js"),i=n.n(s),a=n("./node_modules/lodash/defaults.js"),c=n.n(a),u=n("./src/js/iov/MSEWrapper.js"),d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var f=r()("skyline:clsp:iov:IOVPlayer"),h=r()("silly:skyline:clsp:iov:IOVPlayer"),p=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f("constructor"),this.metrics={},this.events={};for(var r=0;r<e.EVENT_NAMES.length;r++)this.events[e.EVENT_NAMES[r]]=[];this._id=i()(),this.iov=t,this.playerInstance=n,this.eid=this.playerInstance.el().firstChild.id,this.id=this.eid.replace("_html5_api",""),this.initializeVideoElement(),this.options=c()({},o,{segmentIntervalSampleSize:e.SEGMENT_INTERVAL_SAMPLE_SIZE,driftCorrectionConstant:e.DRIFT_CORRECTION_CONSTANT}),this.state="initializing",this.firstFrameShown=!1,this.LogSourceBuffer=!1,this.LogSourceBufferTopic=null,this.latestSegmentReceived=null,this.segmentIntervalAverage=null,this.segmentInterval=null,this.segmentIntervals=[],this.mseWrapper=null,this.moovBox=null,this.guid=null,this.mimeCodec=null}return l(e,null,[{key:"factory",value:function(t,n){return new e(t,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}}]),l(e,[{key:"on",value:function(t,n){if(f("Registering Listener for "+t+" event..."),!e.EVENT_NAMES.includes(t))throw new Error('"'+t+'" is not a valid event."');this.destroyed||this.events[t].push(n)}},{key:"trigger",value:function(t,n){if("metric"===t?h("Triggering "+t+" event..."):f("Triggering "+t+" event..."),!this.destroyed){if(!e.EVENT_NAMES.includes(t))throw new Error('"'+t+'" is not a valid event."');for(var o=0;o<this.events[t].length;o++)this.events[t][o](n,this)}}},{key:"metric",value:function(t,n){if(e.METRIC_TYPES.includes(t)){switch(t){case"video.driftCorrection":this.metrics[t]||(this.metrics[t]=0),this.metrics[t]+=n;break;default:this.metrics[t]=n}this.trigger("metric",{type:t,value:this.metrics[t]})}}},{key:"_onError",value:function(e,t,n){console.error(t),console.error(n)}},{key:"assertMimeCodecSupported",value:function(e){if(!u.default.isMimeCodecSupported(e)){this.state="unsupported-mime-codec";var t="Unsupported mime codec: "+e;throw this.videoPlayer.errors.extend({PLAYER_ERR_IOV:{headline:"Error Playing Stream",message:t}}),this.videoPlayer.error({code:"PLAYER_ERR_IOV"}),new Error(t)}}},{key:"initializeVideoElement",value:function(){var e=this;if(this.videoJsVideoElement=document.getElementById(this.eid),!this.videoJsVideoElement)throw new Error('Unable to find an element in the DOM with id "'+this.eid+'".');var t="clsp-video-"+this._id;this.videoElement=this.videoJsVideoElement.cloneNode(),this.videoElement.setAttribute("id",t),this.videoElement.classList.add("clsp-video"),this.videoElementParent=this.videoJsVideoElement.parentNode,this.on("firstFrameShown",function(){if(null!==e.videoElementParent)try{e.videoElementParent.insertBefore(e.videoElement,e.videoJsVideoElement);for(var n=e.videoElementParent.getElementsByTagName("video"),o=0;o<n.length;o++){var r=n[o],s=r.getAttribute("id");if(s!==e.eid&&s!==t){e.videoElementParent.removeChild(r),r.remove(),r=null,n=null;break}}}catch(e){console.error(e)}})}},{key:"reinitializeMseWrapper",value:function(e){var t=this;if(this.mseWrapper&&this.mseWrapper.destroy(),this.mseWrapper=u.default.factory(this.videoElement),this.mseWrapper.on("metric",function(e){var n=e.type,o=e.value;t.trigger("metric",{type:n,value:o})}),this.mseWrapper.initializeMediaSource({onSourceOpen:function(){var n,o=(n=regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return f("on mediaSource sourceopen"),n.next=3,t.mseWrapper.initializeSourceBuffer(e,{onAppendStart:function(e){if(h("On Append Start..."),!0===t.LogSourceBuffer&&null!==t.LogSourceBufferTopic){f("Recording "+parseInt(e.length)+" bytes of data.");var n=new window.Paho.MQTT.Message(e);n.destinationName=t.LogSourceBufferTopic,window.MQTTClient.send(n)}t.iov.statsMsg.byteCount+=e.length},onAppendFinish:function(e){if(h("On Append Finish..."),t.firstFrameShown||(t.firstFrameShown=!0,t.trigger("firstFrameShown")),t.drift=e.bufferTimeEnd-t.videoElement.currentTime,t.metric("sourceBuffer.bufferTimeEnd",e.bufferTimeEnd),t.metric("video.currentTime",t.videoElement.currentTime),t.metric("video.drift",t.drift),t.drift>t.segmentIntervalAverage/1e3+t.options.driftCorrectionConstant&&(t.metric("video.driftCorrection",1),t.videoElement.currentTime=e.bufferTimeEnd),!0===t.videoElement.paused){f("Video is paused!");try{var n=t.videoElement.play();"undefined"!==typeof n&&n.catch(function(e){t._onError("videojs.play.promise","Error while trying to play videojs player",e)})}catch(e){t._onError("videojs.play.notPromise","Error while trying to play videojs player",e)}}},onRemoveFinish:function(e){f("onRemoveFinish")},onAppendError:function(n){t._onError("sourceBuffer.append","Error while appending to sourceBuffer",n),t.reinitializeMseWrapper(e)},onRemoveError:function(e){"DOMException"!==e.constructor.name&&t._onError("sourceBuffer.remove","Error while removing segments from sourceBuffer",e)},onStreamFrozen:function(){f("stream appears to be frozen - reinitializing..."),t.reinitializeMseWrapper(e)},onError:function(e){t._onError("mediaSource.sourceBuffer.generic","mediaSource sourceBuffer error",e)}});case 3:t.trigger("videoInfoReceived"),t.mseWrapper.appendMoov(t.moovBox);case 5:case"end":return n.stop()}},n,t)}),function(){var e=n.apply(this,arguments);return new Promise(function(t,n){return function o(r,s){try{var i=e[r](s),a=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(a).then(function(e){o("next",e)},function(e){o("throw",e)});t(a)}("next")})});return function(){return o.apply(this,arguments)}}(),onSourceEnded:function(){f("on mediaSource sourceended"),t.stop()},onError:function(e){t._onError("mediaSource.generic","mediaSource error",e)}}),!this.mseWrapper.mediaSource||!this.videoElement)throw new Error("The video element or mediaSource is not ready!");this.mseWrapper.reinitializeVideoElementSrc()}},{key:"resyncStream",value:function(e){var t=this;f("Trying to resync stream..."),this.iov.conduit.subscribe("iov/video/"+this.guid+"/resync",function(){f("sync received re-initialize media source buffer"),t.reinitializeMseWrapper(e)})}},{key:"restart",value:function(){f("restart"),this.stop(),this.play()}},{key:"play",value:function(e){var t=this;f("play"),this.iov.conduit.transaction("iov/video/"+window.btoa(this.iov.config.streamName)+"/request",function(){return t.onIovPlayTransaction.apply(t,arguments)},{clientId:this.iov.config.clientId})}},{key:"stop",value:function(){f("stop"),this.moovBox=null,void 0!==this.guid&&this.iov.conduit.unsubscribe("iov/video/"+this.guid+"/live"),this.iov.conduit.publish("iov/video/"+this.guid+"/stop",{clientId:this.iov.config.clientId})}},{key:"getSegmentIntervalMetrics",value:function(){var e=this.latestSegmentReceived;if(this.latestSegmentReceived=Date.now(),e&&(this.segmentInterval=this.latestSegmentReceived-e),this.segmentInterval){this.segmentIntervals.length>=this.options.segmentIntervalSampleSize&&this.segmentIntervals.shift(),this.segmentIntervals.push(this.segmentInterval);for(var t=0,n=0;n<this.segmentIntervals.length;n++)t+=this.segmentIntervals[n];this.segmentIntervalAverage=t/this.segmentIntervals.length,this.metric("video.segmentInterval",this.segmentInterval),this.metric("video.segmentIntervalAverage",this.segmentIntervalAverage)}}},{key:"onIovPlayTransaction",value:function(e){var t=this,n=e.mimeCodec,o=e.guid;f("onIovPlayTransaction"),this.assertMimeCodecSupported(n);var r=this.iov.config.clientId+"/init-segment/"+parseInt(1e6*Math.random());this.state="waiting-for-first-moov",this.iov.conduit.subscribe(r,function(e){var s=e.payloadBytes;f("onIovPlayTransaction "+r+" listener fired"),f('received moov of type "'+("undefined"===typeof s?"undefined":d(s))+'" from server');var i=s;t.state="waiting-for-first-moof",t.iov.conduit.unsubscribe(r);var a="iov/video/"+o+"/live";t.iov.conduit.subscribe(a,function(e){t.trigger("videoReceived"),t.getSegmentIntervalMetrics(),t.mseWrapper.append(e.payloadBytes)}),t.guid=o,t.moovBox=i,t.mimeCodec=n,t.reinitializeMseWrapper(n),t.resyncStream(n)}),this.iov.conduit.publish("iov/video/"+o+"/play",{initSegmentTopic:r,clientId:this.iov.config.clientId})}},{key:"destroy",value:function(){this.destroyed||(this.destroyed=!0,this.stop(),this.iov=null,this.state=null,this.firstFrameShown=null,this.playerInstance=null,this.videoJsVideoElement=null,this.videoElementParent=null,this.events=null,this.metrics=null,this.LogSourceBuffer=null,this.LogSourceBufferTopic=null,this.latestSegmentReceived=null,this.segmentIntervalAverage=null,this.segmentInterval=null,this.segmentIntervals=null,this.guid=null,this.moovBox=null,this.mimeCodec=null,this.mseWrapper.destroy(),this.mseWrapper=null,this.videoElement.src="",this.videoElement=null)}}]),e}();p.EVENT_NAMES=["metric","firstFrameShown","videoReceived","videoInfoReceived"],p.METRIC_TYPES=["sourceBuffer.bufferTimeEnd","video.currentTime","video.drift","video.driftCorrection","video.segmentInterval","video.segmentIntervalAverage"],p.SEGMENT_INTERVAL_SAMPLE_SIZE=5,p.DRIFT_CORRECTION_CONSTANT=2,t.default=p},"./src/js/utils.js":function(e,t,n){"use strict";n.r(t);var o=52;t.default={supported:function(){if(!Boolean(window.chrome))return!1;try{return parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10)>=o}catch(e){return!1}}}},"./src/js/videojs-mse-over-clsp.js":function(e,t,n){"use strict";n.r(t);n("./node_modules/videojs-errors/dist/videojs-errors.es.js"),n("./node_modules/srcdoc-polyfill/srcdoc-polyfill.js"),n("./src/js/conduit/clspConduit.generated.js");var o=n("./src/js/MseOverMqttPlugin.js"),r=(n("./src/styles/videojs-mse-over-clsp.scss"),Object(o.default)());r.register(),t.default=r},"./src/styles/videojs-mse-over-clsp.scss":function(e,t){},0:function(e,t,n){e.exports=n("./src/js/videojs-mse-over-clsp.js")},1:function(e,t){},"video.js":function(e,t){e.exports=videojs}});